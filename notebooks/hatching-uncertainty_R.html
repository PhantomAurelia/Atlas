
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Calculation and hatching of the uncertainty in projected delta changes. &#8212; IPCC-ATLAS Jupyter Book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "PhantomAurelia/Atlas");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Computing and visualization of precipitation linear trends during the observed period (1980-2014)" href="linear-trends_R.html" />
    <link rel="prev" title="GeoTIFF file post-processing: Spatial operations" href="GeoTIFF-post-processing_R.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">IPCC-ATLAS Jupyter Book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Repository supporting the implementation of FAIR principles in the IPCC-WGI Atlas
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Readmes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../warming-levels/warming-levels.html">
   Global Warming Levels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-sources/data-sources.html">
   Data sources used in the Atlas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference-grids/reference-grids.html">
   Sets of reference grids
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets-interactive-atlas/datasets-interactive-atlas.html">
   Code for reproducibility of the Interactive Atlas Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference-regions/reference-regions.html">
   Sets of regions for regional synthesis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets-aggregated-regionally/datasets-aggregated-regionally.html">
   Aggregated datasets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Notebooks
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks.html">
   Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="regional-scatter-plots_R.html">
   Atlas notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="global-warming-levels_R.html">
   Computing and visualizing transient global warming levels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bias-adjustment_R.html">
   Bias adjustment of model temperatures for the calculation of extreme indices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CORDEX-overlaps_Python.html">
   Selecting reference regions used for every CORDEX domain
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="GeoTIFF-post-processing_R.html">
   GeoTIFF file post-processing: Spatial operations
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Calculation and hatching of the uncertainty in projected delta changes.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear-trends_R.html">
   Computing and visualization of precipitation linear trends during the observed period (1980-2014)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reference-grids_R.html">
   Using the Atlas reference grids in
   <code class="docutils literal notranslate">
    <span class="pre">
     R
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reference-regions_Python.html">
   Using the 4th version of the IPCC WGI reference regions in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reference-regions_R.html">
   Using the 4th version of the IPCC WGI reference regions in R
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stripes-plots_R.html">
   Create stripes of anual temperature and precipitation mean values.
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Anexos
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ERRATA.html">
   Errata and problem reporting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reproducibility/reproducibility.html">
   Reproducibility scripts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="auxiliary-material/auxiliary-material.html">
   Auxiliary Materials for Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../binder/binder.html">
   Binder image deployment
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/PhantomAurelia/Atlas/jb-test?urlpath=tree/./notebooks/hatching-uncertainty_R.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/PhantomAurelia/Atlas"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/PhantomAurelia/Atlas/issues/new?title=Issue%20on%20page%20%2Fnotebooks/hatching-uncertainty_R.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/PhantomAurelia/Atlas/edit/jb-test/./notebooks/hatching-uncertainty_R.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notebooks/hatching-uncertainty_R.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-libraries-and-functions">
   Load libraries and functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-easy-one-step-way-to-create-maps-including-uncertainty-information">
   (A) Easy one-step way to create maps including uncertainty information
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#b-explicit-step-by-step-illustration-of-the-inner-workings-to-include-uncertainty-information">
   (B) Explicit step-by-step illustration of the inner workings to include uncertainty information
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-delta-change">
     Calculate delta change
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-simple-uncertainty-method">
     The “simple” uncertainty method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-advanced-uncertainty-method">
     The “advanced” uncertainty method
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#session-information">
   Session Information
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Calculation and hatching of the uncertainty in projected delta changes.</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-libraries-and-functions">
   Load libraries and functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-easy-one-step-way-to-create-maps-including-uncertainty-information">
   (A) Easy one-step way to create maps including uncertainty information
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#b-explicit-step-by-step-illustration-of-the-inner-workings-to-include-uncertainty-information">
   (B) Explicit step-by-step illustration of the inner workings to include uncertainty information
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-delta-change">
     Calculate delta change
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-simple-uncertainty-method">
     The “simple” uncertainty method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-advanced-uncertainty-method">
     The “advanced” uncertainty method
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#session-information">
   Session Information
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Atlas notebooks

***

&gt; This notebook reproduces and extends parts of the figures and products of the AR6-WGI Atlas. It is part of a notebook collection available at https://github.com/IPCC-WG1/Atlas for reproducibility and reusability purposes. This work is licensed under a [Creative Commons Attribution 4.0 International License](http://creativecommons.org/licenses/by/4.0).
&gt;
&gt; ![Creative Commons License &gt;](https://i.creativecommons.org/l/by/4.0/88x31.png)
</pre></div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="calculation-and-hatching-of-the-uncertainty-in-projected-delta-changes">
<span id="hatching-uncertainty"></span><h1>Calculation and hatching of the uncertainty in projected delta changes.<a class="headerlink" href="#calculation-and-hatching-of-the-uncertainty-in-projected-delta-changes" title="Permalink to this headline">#</a></h1>
<p>08/07/2021</p>
<p><strong>M. Iturbide</strong> (Santander Meteorology Group. Institute of Physics of Cantabria, CSIC-UC, Santander, Spain).</p>
<p>This notebook is an example of calculation and visualization of the AR6-WGI uncertainty methods (simple and advanced) for projected delta changes. Please refer to the AR6 WGI Cross-Chapter Box Atlas 1 for more information.</p>
<p>Example data available at <span class="xref myst">auxiliary-material</span> is used. The base hatching R-functions are defined in <a class="reference download internal" download="" href="../_downloads/b8fec28adb28f63a63e6e0ec416b1546/hatching-functions.R"><code class="xref download docutils literal notranslate"><span class="pre">datasets-interactive-atlas/hatching-functions/hatching-functions.R</span></code></a>.</p>
<p>Two main sections in this notebook provide two ways of creating hatched maps:</p>
<ul class="simple">
<li><p>(A) An <strong>easy one-step way</strong> to create maps including uncertainty information</p></li>
<li><p>(B) An <strong>explicit step-by-step way</strong> to illustrate the inner workings of including uncertainty information</p></li>
</ul>
<section id="load-libraries-and-functions">
<h2>Load libraries and functions<a class="headerlink" href="#load-libraries-and-functions" title="Permalink to this headline">#</a></h2>
<p>We will use the following climate4R libraries:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">loadeR</span></code> to load data (<a class="reference external" href="https://doi.org/10.1016/j.envsoft.2018.09.009">Iturbide et al., 2018</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">visualizeR</span></code> for data visualization (<a class="reference external" href="https://doi.org/10.1016/j.envsoft.2017.09.008">Frías et al., 2018</a>)</p></li>
</ul>
<p>We will also need:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sp</span></code> to work with spatial data (<a class="reference external" href="https://cran.r-project.org/doc/Rnews/Rnews_2005-2.pdf">Pebesma &amp; Bivand, 2005</a>)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">loadeR</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">visualizeR</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: rJava
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: loadeR.java
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Java version 11x amd64 by Azul Systems, Inc. detected
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NetCDF Java Library v4.6.0-SNAPSHOT (23 Apr 2015) loaded and ready
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: climate4R.UDG
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>climate4R.UDG version 0.2.3 (2021-07-05) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: Your current version of climate4R.UDG (v0.2.3) is not up-to-date
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Get the latest stable version (0.2.4) using &lt;devtools::install_github(&#39;SantanderMetGroup/climate4R.UDG&#39;)&gt;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Please use &#39;citation(&quot;climate4R.UDG&quot;)&#39; to cite this package.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>loadeR version 1.7.1 (2021-07-05) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Please use &#39;citation(&quot;loadeR&quot;)&#39; to cite this package.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: transformeR
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    _______   ____  ___________________  __  ________ 
   / ___/ /  / /  |/  / __  /_  __/ __/ / / / / __  / 
  / /  / /  / / /|_/ / /_/ / / / / __/ / /_/ / /_/_/  
 / /__/ /__/ / /  / / __  / / / / /__ /___  / / \ \ 
 \___/____/_/_/  /_/_/ /_/ /_/  \___/    /_/\/   \_\ 
 
      github.com/SantanderMetGroup/climate4R
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>transformeR version 2.1.3 (2021-08-04) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: Your current version of transformeR (v2.1.3) is not up-to-date
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Get the latest stable version (2.1.4) using &lt;devtools::install_github(&#39;SantanderMetGroup/transformeR&#39;)&gt;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Please see &#39;citation(&quot;transformeR&quot;)&#39; to cite this package.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>visualizeR version 1.6.1 (2021-03-11) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Please see &#39;citation(&quot;visualizeR&quot;)&#39; to cite this package.
</pre></div>
</div>
</div>
</div>
<p>The base <strong>hatching R-functions</strong> are defined in <span class="xref myst">datasets-interactive-atlas / hatching-functions / hatching-functions.R</span>. Additionally, a wrapper function applying the previous is also available in <span class="xref myst">datasets-interactive-atlas / hatching-functions / AR6-WGI-hatching.R</span>. To load the functions in the working environment use the <code class="docutils literal notranslate"><span class="pre">source</span></code> R base function as follows.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">source</span><span class="p">(</span><span class="s">&quot;../datasets-interactive-atlas/hatching-functions/hatching-functions.R&quot;</span><span class="p">)</span>
<span class="nf">source</span><span class="p">(</span><span class="s">&quot;../datasets-interactive-atlas/hatching-functions/AR6-WGI-hatching.R&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The scripts are available for download:</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../_downloads/b8fec28adb28f63a63e6e0ec416b1546/hatching-functions.R"><code class="xref download docutils literal notranslate"><span class="pre">hatching-functions.R</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/47ba7ef97df83c510bd24c4283b0c84c/AR6-WGI-hatching.R"><code class="xref download docutils literal notranslate"><span class="pre">AR6-WGI-hatching.R</span></code></a></p></li>
</ul>
</section>
<section id="a-easy-one-step-way-to-create-maps-including-uncertainty-information">
<h2>(A) Easy one-step way to create maps including uncertainty information<a class="headerlink" href="#a-easy-one-step-way-to-create-maps-including-uncertainty-information" title="Permalink to this headline">#</a></h2>
<p>This one-step way uses the <code class="docutils literal notranslate"><span class="pre">AR6.WGI.hatching</span></code> function. It requires one or two data objects; the delta change and, if the advanced method is chosen, also the historical reference.</p>
<p>The <strong>data used in this section</strong> is available under the <span class="xref myst">auxiliary-material</span> folder. There are two NetCDFs of CMIP6 JJA (June-July-August) data for South America, containing the SSP5-8.5 precipitation delta change for the long term (2081-2100 w.r.t baseline 1995-2014) and annual JJA precipitation data for the historical pre-industrial reference 1850-1900, respectively.</p>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">dataInventory</span></code> function from <code class="docutils literal notranslate"><span class="pre">loadeR</span></code> to check basic data information, e.g.:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">di</span> <span class="o">&lt;-</span> <span class="nf">dataInventory</span><span class="p">(</span><span class="s">&quot;auxiliary-material/CMIP6_SAM_historical_JJA_pr_1850-1900_annual.nc&quot;</span><span class="p">)</span>
<span class="nf">str</span><span class="p">(</span><span class="n">di</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:22] Doing inventory ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:26] Retrieving info for &#39;pr&#39; (0 vars remaining)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:26] Done.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>List of 1
 $ pr:List of 7
  ..$ Description: chr &quot;Precipitation&quot;
  ..$ DataType   : chr &quot;float&quot;
  ..$ Shape      : int [1:4] 51 33 69 50
  ..$ Units      : chr &quot;mm&quot;
  ..$ DataSizeMb : num 23.2
  ..$ Version    : logi NA
  ..$ Dimensions :List of 4
  .. ..$ member:List of 3
  .. .. ..$ Type  : chr &quot;Ensemble&quot;
  .. .. ..$ Units : chr &quot;&quot;
  .. .. ..$ Values: chr [1:33] &quot;ACCESS-CM2_r1i1p1f1&quot; &quot;ACCESS-ESM1-5_r1i1p1f1&quot; &quot;BCC-CSM2-MR_r1i1p1f1&quot; &quot;CAMS-CSM1-0_r2i1p1f1&quot; ...
  .. ..$ time  :List of 4
  .. .. ..$ Type      : chr &quot;Time&quot;
  .. .. ..$ TimeStep  : chr &quot;365.24 days&quot;
  .. .. ..$ Units     : chr &quot;days since 1850-06-01 12:00:00 GMT&quot;
  .. .. ..$ Date_range: chr &quot;1850-06-01T12:00:00Z - 1900-06-01T12:00:00Z&quot;
  .. ..$ lat   :List of 5
  .. .. ..$ Type       : chr &quot;Lat&quot;
  .. .. ..$ Units      : chr &quot;degrees_north&quot;
  .. .. ..$ Values     : num [1:69] -56.5 -55.5 -54.5 -53.5 -52.5 -51.5 -50.5 -49.5 -48.5 -47.5 ...
  .. .. ..$ Shape      : int 69
  .. .. ..$ Coordinates: chr &quot;lat&quot;
  .. ..$ lon   :List of 5
  .. .. ..$ Type       : chr &quot;Lon&quot;
  .. .. ..$ Units      : chr &quot;degrees_east&quot;
  .. .. ..$ Values     : num [1:50] -83.5 -82.5 -81.5 -80.5 -79.5 -78.5 -77.5 -76.5 -75.5 -74.5 ...
  .. .. ..$ Shape      : int 50
  .. .. ..$ Coordinates: chr &quot;lon&quot;
</pre></div>
</div>
</div>
</div>
<p>Note that there are 33 CMIP6 models (“member” dimension).</p>
<p>These data can be loaded into variables using <code class="docutils literal notranslate"><span class="pre">loadGridData</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span> <span class="o">&lt;-</span> <span class="nf">loadGridData</span><span class="p">(</span><span class="s">&quot;auxiliary-material/CMIP6_SAM_historical_JJA_pr_1850-1900_annual.nc&quot;</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="s">&quot;pr&quot;</span><span class="p">)</span>
<span class="n">delta</span> <span class="o">&lt;-</span> <span class="nf">loadGridData</span><span class="p">(</span><span class="s">&quot;auxiliary-material/CMIP6_SAM_ssp585_JJA_pr_2081-2100_delta.nc&quot;</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="s">&quot;pr&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:30] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:30] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:30] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:32] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:36] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:36] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:36] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:36] Done
</pre></div>
</div>
</div>
</div>
<p>We only need to apply the <code class="docutils literal notranslate"><span class="pre">AR6.WGI.hatching</span></code> function, which includes the <code class="docutils literal notranslate"><span class="pre">method</span></code> parameter to select the uncertainty method. For instance, in the next example the simple method is selected (<code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">simple</span></code>), which is based on model agreement. Optionally, a list of additional parameters from the <code class="docutils literal notranslate"><span class="pre">map.hatching</span></code> function (package <em>visualizeR</em>) can be passed to argument <code class="docutils literal notranslate"><span class="pre">map.hatching.args</span></code> to control the appearance of the hatches, i.e. density, direction, color, … (type <code class="docutils literal notranslate"><span class="pre">?map.hatching</span></code> for specific documentation).</p>
<p>Finally, additional arguments from the <code class="docutils literal notranslate"><span class="pre">spatialPlot</span></code> function can be also included to control graphical parameters, such as the color theme (e.g. <code class="docutils literal notranslate"><span class="pre">color.theme</span> <span class="pre">=</span> <span class="pre">&quot;BrBG&quot;</span></code>). A list of color themes to use from <code class="docutils literal notranslate"><span class="pre">RColorBrewer</span></code> package can be obtained by issuing <code class="docutils literal notranslate"><span class="pre">RColorBrewer::display.brewer.all()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pl.simple.sam</span> <span class="o">&lt;-</span> <span class="nf">AR6.WGI.hatching</span><span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="n">delta</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;simple&quot;</span><span class="p">,</span> 
                                  <span class="n">map.hatching.args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">density</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="m">1.2</span><span class="p">),</span> 
                                  <span class="n">color.theme</span> <span class="o">=</span> <span class="s">&quot;BrBG&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pl.simple.sam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hatching-uncertainty_R_14_0.png" src="../_images/hatching-uncertainty_R_14_0.png" />
</div>
</div>
<p>To plot the relative delta, it needs to be explicitly provided. In this case, it is available in this repository as auxiliary material. Add more graphical parameters until the desired output is obtained. E.g. we can manually set the range of the color bar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">rel.delta</span> <span class="o">&lt;-</span> <span class="nf">loadGridData</span><span class="p">(</span><span class="s">&quot;auxiliary-material/CMIP6_SAM_ssp585_JJA_pr_2081-2100_relative_delta.nc&quot;</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="s">&quot;pr&quot;</span><span class="p">)</span>
<span class="n">pl.simple.sam</span> <span class="o">&lt;-</span> <span class="nf">AR6.WGI.hatching</span><span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="n">delta</span><span class="p">,</span> <span class="n">relative.delta</span> <span class="o">=</span> <span class="n">rel.delta</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;simple&quot;</span><span class="p">,</span> 
                                  <span class="n">map.hatching.args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">density</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="m">1.2</span><span class="p">),</span> 
                                  <span class="n">color.theme</span> <span class="o">=</span> <span class="s">&quot;BrBG&quot;</span><span class="p">,</span> <span class="n">set.max</span> <span class="o">=</span> <span class="m">50</span><span class="p">,</span> <span class="n">set.min</span> <span class="o">=</span> <span class="m">-50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:40] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:40] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:40] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:40] Done
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pl.simple.sam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hatching-uncertainty_R_17_0.png" src="../_images/hatching-uncertainty_R_17_0.png" />
</div>
</div>
<p>We can change to the <code class="docutils literal notranslate"><span class="pre">advanced</span></code> method easily (<code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">advanced</span></code>). The advanced method is based on the presence/absence of signal with respect to the interannual variability of a reference period (here pre-industrial, 1850-1900). This method has two components:</p>
<ul class="simple">
<li><p>The areas with absence of signals are hatched</p></li>
<li><p>The areas with presence of signal but absence of model agreement are crossed.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pl.advanced.sam</span> <span class="o">&lt;-</span> <span class="nf">AR6.WGI.hatching</span><span class="p">(</span><span class="n">delta</span> <span class="o">=</span> <span class="n">delta</span><span class="p">,</span> <span class="n">historical.ref</span> <span class="o">=</span> <span class="n">ref</span><span class="p">,</span> <span class="n">relative.delta</span> <span class="o">=</span> <span class="n">rel.delta</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;advanced&quot;</span><span class="p">,</span> 
                                  <span class="n">map.hatching.args</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">density</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="m">0.7</span><span class="p">),</span> 
                                  <span class="n">color.theme</span> <span class="o">=</span> <span class="s">&quot;BrBG&quot;</span><span class="p">,</span> <span class="n">set.max</span> <span class="o">=</span> <span class="m">50</span><span class="p">,</span> <span class="n">set.min</span> <span class="o">=</span> <span class="m">-50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pl.advanced.sam</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hatching-uncertainty_R_20_0.png" src="../_images/hatching-uncertainty_R_20_0.png" />
</div>
</div>
<p>To export the map you can use the following code:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">pdf</span><span class="p">(</span><span class="s">&quot;mymap.pdf&quot;</span><span class="p">)</span>
<span class="n">pl.advanced.sam</span>
<span class="nf">dev.off</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="b-explicit-step-by-step-illustration-of-the-inner-workings-to-include-uncertainty-information">
<h2>(B) Explicit step-by-step illustration of the inner workings to include uncertainty information<a class="headerlink" href="#b-explicit-step-by-step-illustration-of-the-inner-workings-to-include-uncertainty-information" title="Permalink to this headline">#</a></h2>
<p>The data used in this section is global and it is available under the <span class="xref myst">auxiliary-material</span> folder. The data consists of two NetCDFs containing CMIP6 JJA historical and SSP5-8.5 precipitation climatologies for the 1986-2005 and 2081-2100 periods, respectively.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">dataInventory</span></code> function from <code class="docutils literal notranslate"><span class="pre">loadeR</span></code> to check basic data information:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">di</span> <span class="o">&lt;-</span> <span class="nf">dataInventory</span><span class="p">(</span><span class="s">&quot;auxiliary-material/CMIP6_historical_JJA_pr_1995-2014.nc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:44] Doing inventory ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:48] Retrieving info for &#39;pr&#39; (0 vars remaining)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:48] Done.
</pre></div>
</div>
</div>
</div>
<p>Load the data into variables using <code class="docutils literal notranslate"><span class="pre">loadGridData</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">hist</span> <span class="o">&lt;-</span> <span class="nf">loadGridData</span><span class="p">(</span><span class="s">&quot;auxiliary-material/CMIP6_historical_JJA_pr_1995-2014.nc&quot;</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="s">&quot;pr&quot;</span><span class="p">)</span>
<span class="n">scen</span> <span class="o">&lt;-</span> <span class="nf">loadGridData</span><span class="p">(</span><span class="s">&quot;auxiliary-material/CMIP6_ssp585_JJA_pr_2081-2100.nc&quot;</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="s">&quot;pr&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:52] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:52] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:52] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:52] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:56] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:56] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:56] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:56] Done
</pre></div>
</div>
</div>
</div>
<section id="calculate-delta-change">
<h3>Calculate delta change<a class="headerlink" href="#calculate-delta-change" title="Permalink to this headline">#</a></h3>
<p>Future delta changes are the arithmetic difference between future and historical time slice climatologies. Relative deltas can also be calculated with respect to the multi-model mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">delta</span> <span class="o">&lt;-</span> <span class="nf">gridArithmetics</span><span class="p">(</span><span class="nf">climatology</span><span class="p">(</span><span class="n">scen</span><span class="p">),</span> <span class="nf">climatology</span><span class="p">(</span><span class="n">hist</span><span class="p">),</span> <span class="n">operator</span> <span class="o">=</span> <span class="s">&quot;-&quot;</span><span class="p">)</span>
<span class="n">ensemble.mean</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span> <span class="nf">aggregateGrid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">aggr.mem</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">FUN</span> <span class="o">=</span> <span class="n">mean</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="bp">T</span><span class="p">))</span>
<span class="n">delta.ens</span> <span class="o">&lt;-</span> <span class="nf">ensemble.mean</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
<span class="n">hist.ens</span> <span class="o">&lt;-</span> <span class="nf">ensemble.mean</span><span class="p">(</span><span class="nf">climatology</span><span class="p">(</span><span class="n">hist</span><span class="p">))</span>
<span class="c1"># Relative delta</span>
<span class="n">rel.delta</span> <span class="o">&lt;-</span> <span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">delta.ens</span><span class="p">,</span> 
                             <span class="n">hist.ens</span><span class="p">,</span> 
                             <span class="m">100</span><span class="p">,</span> 
                             <span class="n">operator</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span> <span class="s">&quot;*&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:56] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:01] - Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:02] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:07] - Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:08] - Aggregating members...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:08] - Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:08] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:13] - Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:13] - Aggregating members...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:14] - Done.
</pre></div>
</div>
</div>
</div>
<p>Check the output with a first visualization of the delta change for each member of the ensemble.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">spatialPlot</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="n">backdrop.theme</span> <span class="o">=</span> <span class="s">&quot;coastline&quot;</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;delta&quot;</span><span class="p">,</span> 
           <span class="n">set.max</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">set.min</span> <span class="o">=</span> <span class="m">-5</span><span class="p">,</span> <span class="n">color.theme</span> <span class="o">=</span> <span class="s">&quot;BrBG&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hatching-uncertainty_R_30_0.png" src="../_images/hatching-uncertainty_R_30_0.png" />
</div>
</div>
<p>And this would be the relative delta change for the ensemble mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">spatialPlot</span><span class="p">(</span><span class="n">rel.delta</span><span class="p">,</span> <span class="n">backdrop.theme</span> <span class="o">=</span> <span class="s">&quot;coastline&quot;</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;relative delta&quot;</span><span class="p">,</span> 
           <span class="n">set.max</span> <span class="o">=</span> <span class="m">60</span><span class="p">,</span> <span class="n">set.min</span> <span class="o">=</span> <span class="m">-60</span><span class="p">,</span> <span class="n">color.theme</span> <span class="o">=</span> <span class="s">&quot;BrBG&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hatching-uncertainty_R_32_0.png" src="../_images/hatching-uncertainty_R_32_0.png" />
</div>
</div>
</section>
<section id="the-simple-uncertainty-method">
<h3>The “simple” uncertainty method<a class="headerlink" href="#the-simple-uncertainty-method" title="Permalink to this headline">#</a></h3>
<p>We compute now the simple uncertainty measure (<code class="docutils literal notranslate"><span class="pre">agreement</span></code> function) and check the result visually. Note that argument <code class="docutils literal notranslate"><span class="pre">th</span></code> allows to set the agreement threshold.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">simple</span> <span class="o">&lt;-</span> <span class="nf">aggregateGrid</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="n">aggr.mem</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">FUN</span> <span class="o">=</span> <span class="n">agreement</span><span class="p">,</span> <span class="n">th</span> <span class="o">=</span> <span class="m">80</span><span class="p">))</span>
<span class="nf">spatialPlot</span><span class="p">(</span><span class="n">simple</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:22] - Aggregating members...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:22] - Done.
</pre></div>
</div>
<img alt="../_images/hatching-uncertainty_R_35_2.png" src="../_images/hatching-uncertainty_R_35_2.png" />
</div>
</div>
<p>This simple approach represents model agreement with two categories: 1 indicates high model agreement, where at least 80% of models agree on the sign of change; 0 indicates low model agreement, where fewer than 80% of models agree on sign of change. Note that model agreement is computed at a gridbox level and is not representative of regionally aggregated results over larger regions.</p>
<p>This binary mask can be used to create the spatial object of the hatches, which we will then overlay on the original plots, hatching the areas where there is not enough model agreement. Let’s obtain the hatching and check visually.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">simple.hatch</span> <span class="o">&lt;-</span> <span class="nf">map.hatching</span><span class="p">(</span><span class="n">clim</span> <span class="o">=</span> <span class="nf">climatology</span><span class="p">(</span><span class="n">simple</span><span class="p">),</span> <span class="n">threshold</span> <span class="o">=</span> <span class="s">&quot;0.5&quot;</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="s">&quot;-45&quot;</span><span class="p">,</span>
                             <span class="n">condition</span> <span class="o">=</span> <span class="s">&quot;LT&quot;</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span>  <span class="n">lwd</span> <span class="o">=</span> <span class="m">0.6</span><span class="p">,</span>
                             <span class="n">upscaling.aggr.fun</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">FUN</span> <span class="o">=</span> <span class="n">mean</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">simple.hatch</span><span class="p">[[</span><span class="m">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:22] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:22] - Done.
</pre></div>
</div>
<img alt="../_images/hatching-uncertainty_R_37_2.png" src="../_images/hatching-uncertainty_R_37_2.png" />
</div>
</div>
<p>We can overlay the hatching on the relative delta to produce the final figure (the hatches are passed to argument <code class="docutils literal notranslate"><span class="pre">sp.layout</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pl.simple</span> <span class="o">&lt;-</span> <span class="nf">spatialPlot</span><span class="p">(</span><span class="n">rel.delta</span><span class="p">,</span> 
            <span class="n">color.theme</span> <span class="o">=</span> <span class="s">&quot;BrBG&quot;</span><span class="p">,</span> 
            <span class="n">at</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">-60</span><span class="p">,</span> <span class="m">60</span><span class="p">,</span> <span class="m">5</span><span class="p">),</span> 
            <span class="n">set.max</span> <span class="o">=</span> <span class="m">60</span><span class="p">,</span> <span class="n">set.min</span> <span class="o">=</span> <span class="m">-60</span><span class="p">,</span>
            <span class="n">backdrop.theme</span> <span class="o">=</span> <span class="s">&quot;coastline&quot;</span><span class="p">,</span>
            <span class="n">main</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;Mean delta change&quot;</span><span class="p">,</span> <span class="n">cex</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">),</span>
            <span class="n">xlab</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;Period: 2081-2100, Season: JJA&quot;</span><span class="p">,</span> <span class="n">cex</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">),</span>
            <span class="n">sp.layout</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">simple.hatch</span><span class="p">),</span>
            <span class="n">par.settings</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">axis.line</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">col</span> <span class="o">=</span> <span class="s">&#39;transparent&#39;</span><span class="p">)))</span>
<span class="n">pl.simple</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hatching-uncertainty_R_39_0.png" src="../_images/hatching-uncertainty_R_39_0.png" />
</div>
</div>
</section>
<section id="the-advanced-uncertainty-method">
<h3>The “advanced” uncertainty method<a class="headerlink" href="#the-advanced-uncertainty-method" title="Permalink to this headline">#</a></h3>
<p>The advanced method is based on the presence/absence of signal with respect to the interannual variability of a reference period (here 1850-1900). This method has two components:</p>
<ul class="simple">
<li><p>The areas with absence of signal are hatched</p></li>
<li><p>The areas with presence of signal but absence of model agreement are crossed.</p></li>
</ul>
<p>To calculate the signal we need the data of the delta change and anual data of the historical reference. Due to file size restrictions on GitHub we do not include the global historical reference. However it would be loaded as follows:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span> <span class="o">&lt;-</span> <span class="nf">loadGridData</span><span class="p">(</span><span class="s">&quot;auxiliary-material/CMIP6_historical_JJA_1850-1900_annual.nc&quot;</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="s">&quot;pr&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we would calculate the signal as follows:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">sign</span> <span class="o">&lt;-</span> <span class="nf">signal</span><span class="p">(</span><span class="n">h</span> <span class="o">=</span> <span class="n">ref</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">delta</span><span class="p">)</span>
</pre></div>
</div>
<p>This repository includes the pre-calculated grid of the signal, load it by executing the following cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sign</span> <span class="o">&lt;-</span> <span class="nf">loadGridData</span><span class="p">(</span><span class="s">&quot;auxiliary-material/CMIP6_ssp585_JJA_pr_2081-2100_signal.nc&quot;</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="s">&quot;pr_signal&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:27] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:27] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:27] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:27] Done
</pre></div>
</div>
</div>
</div>
<p>To obtain the overall signal of the ensemble we use the auxiliary functions <code class="docutils literal notranslate"><span class="pre">signal.ens1</span></code> and <code class="docutils literal notranslate"><span class="pre">signal.ens2</span></code>, which apply a threshold to the ensemble mean signal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">advanced1</span> <span class="o">&lt;-</span> <span class="nf">aggregateGrid</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="n">aggr.mem</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">FUN</span> <span class="o">=</span> <span class="n">signal.ens1</span><span class="p">,</span> <span class="n">th</span> <span class="o">=</span> <span class="m">66</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:28] - Aggregating members...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:28] - Done.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">advanced2.aux</span> <span class="o">&lt;-</span> <span class="nf">aggregateGrid</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="n">aggr.mem</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">FUN</span> <span class="o">=</span> <span class="n">signal.ens2</span><span class="p">,</span> <span class="n">th</span> <span class="o">=</span> <span class="m">66</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:28] - Aggregating members...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:28] - Done.
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">signal.ens1</span></code> returns the first component of the advanced method (where 0 = absence of signal), while <code class="docutils literal notranslate"><span class="pre">signal.ens2</span></code> returns an intermediate grid (where 0 = presence of signal) to calculate the second component in an additional step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">spatialPlot</span><span class="p">(</span><span class="n">advanced1</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;no signal = 0&quot;</span><span class="p">)</span>
<span class="nf">spatialPlot</span><span class="p">(</span><span class="n">advanced2.aux</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;no signal = 1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hatching-uncertainty_R_47_0.png" src="../_images/hatching-uncertainty_R_47_0.png" />
<img alt="../_images/hatching-uncertainty_R_47_1.png" src="../_images/hatching-uncertainty_R_47_1.png" />
</div>
</div>
<p>The additional step consists on combining this map (<code class="docutils literal notranslate"><span class="pre">advanced2.aux</span></code>) with the map we obtained by the simple hatching approach (<code class="docutils literal notranslate"><span class="pre">simple</span></code>). As a result, we get a three-valued map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">advanced2.aux</span> <span class="o">&lt;-</span> <span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">advanced2.aux</span><span class="p">,</span> <span class="n">simple</span><span class="p">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="s">&quot;+&quot;</span><span class="p">)</span> 
<span class="nf">spatialPlot</span><span class="p">(</span><span class="n">advanced2.aux</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hatching-uncertainty_R_49_0.png" src="../_images/hatching-uncertainty_R_49_0.png" />
</div>
</div>
<p>The different values arise from:</p>
<ul class="simple">
<li><p>no signal (1) + agreement (1) = 2</p></li>
<li><p>no signal (1) + disagreement (0) = 1</p></li>
<li><p>signal (0) + agreement (1) = 1</p></li>
<li><p>signal (0) + disagreement (0) = 0</p></li>
</ul>
<p>The second component of the advanced method hatches the forth outcome, i.e. the 0 value, where there is signal but there is no model agreement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">advanced2</span> <span class="o">&lt;-</span> <span class="nf">binaryGrid</span><span class="p">(</span><span class="n">advanced2.aux</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="s">&quot;GT&quot;</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="m">0</span><span class="p">)</span>
<span class="nf">spatialPlot</span><span class="p">(</span><span class="n">advanced2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hatching-uncertainty_R_51_0.png" src="../_images/hatching-uncertainty_R_51_0.png" />
</div>
</div>
<p>We can now create the hatches for the two components (<code class="docutils literal notranslate"><span class="pre">advanced1</span></code> and <code class="docutils literal notranslate"><span class="pre">advanced2</span></code>) of the advanced hatching method. For the second component, we opted for using crosses to obscure the map. To do this, we simply apply again the <code class="docutils literal notranslate"><span class="pre">map.hatching</span></code> function, but using different angles (<code class="docutils literal notranslate"><span class="pre">angle</span> <span class="pre">=</span> <span class="pre">&quot;45&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">angle</span> <span class="pre">=</span> <span class="pre">&quot;-45&quot;</span></code>) each time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">my.hatching</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span> <span class="nf">map.hatching</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span><span class="p">,</span>
                                       <span class="n">condition</span> <span class="o">=</span> <span class="s">&quot;LT&quot;</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span>  <span class="n">lwd</span> <span class="o">=</span> <span class="m">0.6</span><span class="p">,</span>
                                       <span class="n">upscaling.aggr.fun</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">FUN</span> <span class="o">=</span> <span class="n">mean</span><span class="p">))</span>
<span class="n">advanced1.hatch</span> <span class="o">&lt;-</span> <span class="nf">my.hatching</span><span class="p">(</span><span class="nf">climatology</span><span class="p">(</span><span class="n">advanced1</span><span class="p">),</span> <span class="s">&quot;-45&quot;</span><span class="p">)</span>
<span class="n">advanced2.hatch</span> <span class="o">&lt;-</span> <span class="nf">my.hatching</span><span class="p">(</span><span class="nf">climatology</span><span class="p">(</span><span class="n">advanced2</span><span class="p">),</span>  <span class="s">&quot;45&quot;</span><span class="p">)</span>
<span class="n">advanced2.hatch.bis</span> <span class="o">&lt;-</span> <span class="nf">my.hatching</span><span class="p">(</span><span class="nf">climatology</span><span class="p">(</span><span class="n">advanced2</span><span class="p">),</span> <span class="s">&quot;-45&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:29] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:29] - Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:30] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:30] - Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:30] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:08:30] - Done.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">advanced1.hatch</span><span class="p">[[</span><span class="m">2</span><span class="p">]])</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">advanced2.hatch</span><span class="p">[[</span><span class="m">2</span><span class="p">]],</span> <span class="n">add</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">advanced2.hatch.bis</span><span class="p">[[</span><span class="m">2</span><span class="p">]],</span> <span class="n">add</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hatching-uncertainty_R_54_0.png" src="../_images/hatching-uncertainty_R_54_0.png" />
</div>
</div>
<p>We can overlay the hatching on the relative delta to produce the final figure (the hatches are passed to argument <code class="docutils literal notranslate"><span class="pre">sp.layout</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pl.advanced</span> <span class="o">&lt;-</span> <span class="nf">spatialPlot</span><span class="p">(</span><span class="n">rel.delta</span><span class="p">,</span> 
            <span class="n">color.theme</span> <span class="o">=</span> <span class="s">&quot;BrBG&quot;</span><span class="p">,</span> 
            <span class="n">at</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">-60</span><span class="p">,</span> <span class="m">60</span><span class="p">,</span> <span class="m">5</span><span class="p">),</span> 
            <span class="n">set.max</span> <span class="o">=</span> <span class="m">60</span><span class="p">,</span> <span class="n">set.min</span> <span class="o">=</span> <span class="m">-60</span><span class="p">,</span>
            <span class="n">backdrop.theme</span> <span class="o">=</span> <span class="s">&quot;coastline&quot;</span><span class="p">,</span>
            <span class="n">main</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;Mean delta change&quot;</span><span class="p">,</span> <span class="n">cex</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">),</span>
            <span class="n">xlab</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="s">&quot;Period: 2081-2100, Season: JJA&quot;</span><span class="p">,</span> <span class="n">cex</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">),</span>
            <span class="n">sp.layout</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">advanced1.hatch</span><span class="p">,</span> <span class="n">advanced2.hatch</span><span class="p">,</span> <span class="n">advanced2.hatch.bis</span><span class="p">),</span>
            <span class="n">par.settings</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">axis.line</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">col</span> <span class="o">=</span> <span class="s">&#39;transparent&#39;</span><span class="p">)))</span>
<span class="n">pl.advanced</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hatching-uncertainty_R_56_0.png" src="../_images/hatching-uncertainty_R_56_0.png" />
</div>
</div>
<p>We could also add the hatching to the ensemble mean of the absolute deltas (instead of the relative ones) just replacing in the above code the first line by:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span> <span class="o">&lt;-</span> <span class="nf">spatialPlot</span><span class="p">(</span><span class="nf">ensemble.mean</span><span class="p">(</span><span class="n">delta</span><span class="p">),</span> <span class="kc">...</span>
</pre></div>
</div>
</section>
</section>
<section id="session-information">
<h2>Session Information<a class="headerlink" href="#session-information" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">sessionInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R version 3.6.3 (2020-02-29)
Platform: x86_64-conda-linux-gnu (64-bit)
Running under: Fedora Linux 36 (Workstation Edition)

Matrix products: default
BLAS/LAPACK: /home/phanaur/mambaforge/envs/tfg/lib/libopenblasp-r0.3.21.so

locale:
 [1] LC_CTYPE=es_ES.UTF-8          LC_NUMERIC=C                 
 [3] LC_TIME=es_ES.UTF-8           LC_COLLATE=es_ES.UTF-8       
 [5] LC_MONETARY=es_ES.UTF-8       LC_MESSAGES=es_ES.UTF-8      
 [7] LC_PAPER=es_ES.UTF-8          LC_NAME=es_ES.UTF-8          
 [9] LC_ADDRESS=es_ES.UTF-8        LC_TELEPHONE=es_ES.UTF-8     
[11] LC_MEASUREMENT=es_ES.UTF-8    LC_IDENTIFICATION=es_ES.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] sp_1.4-5            visualizeR_1.6.1    transformeR_2.1.3  
[4] loadeR_1.7.1        climate4R.UDG_0.2.3 loadeR.java_1.1.1  
[7] rJava_1.0-4        

loaded via a namespace (and not attached):
 [1] viridis_0.6.1           maps_3.3.0              jsonlite_1.7.2         
 [4] viridisLite_0.4.0       SpecsVerification_0.5-3 dotCall64_1.0-1        
 [7] kohonen_3.0.10          sm_2.2-5.6              latticeExtra_0.6-29    
[10] pillar_1.6.1            lattice_0.20-44         glue_1.4.2             
[13] RcppEigen_0.3.3.9.1     uuid_0.1-4              digest_0.6.27          
[16] RColorBrewer_1.1-2      colorspace_2.0-1        htmltools_0.5.1.1      
[19] Matrix_1.3-3            pkgconfig_2.0.3         padr_0.5.3             
[22] purrr_0.3.4             scales_1.1.1            jpeg_0.1-8.1           
[25] CircStats_0.2-6         dtw_1.22-3              tibble_3.1.2           
[28] proxy_0.4-25            generics_0.1.0          ggplot2_3.3.3          
[31] ellipsis_0.3.2          repr_1.1.3              verification_1.42      
[34] pbapply_1.4-3           magrittr_2.0.1          crayon_1.4.1           
[37] easyVerification_0.4.4  evaluate_0.14           fansi_0.4.2            
[40] MASS_7.3-54             tools_3.6.3             data.table_1.14.0      
[43] lifecycle_1.0.0         munsell_0.5.0           akima_0.6-2.1          
[46] compiler_3.6.3          mapplots_1.5.1          rlang_0.4.11           
[49] grid_3.6.3              RCurl_1.98-1.3          pbdZMQ_0.3-5           
[52] IRkernel_1.2            spam_2.6-0              bitops_1.0-7           
[55] tcltk_3.6.3             base64enc_0.1-3         boot_1.3-28            
[58] vioplot_0.3.6           gtable_0.3.0            abind_1.4-5            
[61] R6_2.5.0                gridExtra_2.3           zoo_1.8-9              
[64] rgdal_1.5-16            dplyr_1.0.6             utf8_1.2.1             
[67] parallel_3.6.3          IRdisplay_1.0           Rcpp_1.0.6             
[70] fields_12.3             vctrs_0.3.8             png_0.1-7              
[73] tidyselect_1.1.1       
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="GeoTIFF-post-processing_R.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">GeoTIFF file post-processing: Spatial operations</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="linear-trends_R.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Computing and visualization of precipitation linear trends during the observed period (1980-2014)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By David Domínguez Román<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>