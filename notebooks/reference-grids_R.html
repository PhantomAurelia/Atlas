
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Using the Atlas reference grids in R &#8212; IPCC-ATLAS Jupyter Book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "PhantomAurelia/Atlas");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using the 4th version of the IPCC WGI reference regions in Python" href="reference-regions_Python.html" />
    <link rel="prev" title="Computing and visualization of precipitation linear trends during the observed period (1980-2014)" href="linear-trends_R.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">IPCC-ATLAS Jupyter Book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Repository supporting the implementation of FAIR principles in the IPCC-WGI Atlas
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Readmes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../warming-levels/warming-levels.html">
   Global Warming Levels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-sources/data-sources.html">
   Data sources used in the Atlas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference-grids/reference-grids.html">
   Sets of reference grids
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets-interactive-atlas/datasets-interactive-atlas.html">
   Code for reproducibility of the Interactive Atlas Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference-regions/reference-regions.html">
   Sets of regions for regional synthesis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets-aggregated-regionally/datasets-aggregated-regionally.html">
   Aggregated datasets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Notebooks
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks.html">
   Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="regional-scatter-plots_R.html">
   Atlas notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="global-warming-levels_R.html">
   Computing and visualizing transient global warming levels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bias-adjustment_R.html">
   Bias adjustment of model temperatures for the calculation of extreme indices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CORDEX-overlaps_Python.html">
   Selecting reference regions used for every CORDEX domain
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="GeoTIFF-post-processing_R.html">
   GeoTIFF file post-processing: Spatial operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hatching-uncertainty_R.html">
   Calculation and hatching of the uncertainty in projected delta changes.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear-trends_R.html">
   Computing and visualization of precipitation linear trends during the observed period (1980-2014)
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Using the Atlas reference grids in
   <code class="docutils literal notranslate">
    <span class="pre">
     R
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reference-regions_Python.html">
   Using the 4th version of the IPCC WGI reference regions in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reference-regions_R.html">
   Using the 4th version of the IPCC WGI reference regions in R
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stripes-plots_R.html">
   Create stripes of anual temperature and precipitation mean values.
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Anexos
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ERRATA.html">
   Errata and problem reporting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reproducibility/reproducibility.html">
   Reproducibility scripts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="auxiliary-material/auxiliary-material.html">
   Auxiliary Materials for Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../binder/binder.html">
   Binder image deployment
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/PhantomAurelia/Atlas/jb-test?urlpath=tree/./notebooks/reference-grids_R.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/PhantomAurelia/Atlas"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/PhantomAurelia/Atlas/issues/new?title=Issue%20on%20page%20%2Fnotebooks/reference-grids_R.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/PhantomAurelia/Atlas/edit/jb-test/./notebooks/reference-grids_R.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notebooks/reference-grids_R.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-libraries">
   Load libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-the-reference-land-sea-mask">
   Load the reference land/sea mask
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-model-data">
   Load model data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interpolation">
   Interpolation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apply-the-mask-to-the-data">
   Apply the mask to the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#masked-vs-non-masked-time-series">
   Masked vs. non masked time-series
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#session-info">
   Session info
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Using the Atlas reference grids in R</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-libraries">
   Load libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-the-reference-land-sea-mask">
   Load the reference land/sea mask
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-model-data">
   Load model data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interpolation">
   Interpolation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apply-the-mask-to-the-data">
   Apply the mask to the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#masked-vs-non-masked-time-series">
   Masked vs. non masked time-series
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#session-info">
   Session info
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Atlas notebooks

***

&gt; This notebook reproduces and extends parts of the figures and products of the AR6-WGI Atlas. It is part of a notebook collection available at https://github.com/IPCC-WG1/Atlas for reproducibility and reusability purposes. This work is licensed under a [Creative Commons Attribution 4.0 International License](http://creativecommons.org/licenses/by/4.0).
&gt;
&gt; ![Creative Commons License &gt;](https://i.creativecommons.org/l/by/4.0/88x31.png)
</pre></div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="using-the-atlas-reference-grids-in-r">
<span id="reference-grids"></span><h1>Using the Atlas reference grids in <code class="docutils literal notranslate"><span class="pre">R</span></code><a class="headerlink" href="#using-the-atlas-reference-grids-in-r" title="Permalink to this headline">#</a></h1>
<p>22/07/2021</p>
<p><strong>M. Iturbide</strong> (<a class="reference external" href="http://meteo.unican.es">Santander Meteorology Group</a>, Instituto de Física de Cantabria, CSIC-UC, Santander, Spain)</p>
<p>This is a simple example which illustrates how the Atlas reference grids can be used in <code class="docutils literal notranslate"><span class="pre">R</span></code> for both interpolation and land/sea separation of the simulations provided by a global climate model.</p>
<section id="load-libraries">
<h2>Load libraries<a class="headerlink" href="#load-libraries" title="Permalink to this headline">#</a></h2>
<p>The following climate4R (C4R hereafter) libraries are needed to run this notebook:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">loadeR</span></code> to load data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">visualizeR</span></code> to display the results</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">convertR</span></code> to change units</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">loadeR</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">visualizeR</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">convertR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: rJava
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: loadeR.java
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Java version 11x amd64 by Azul Systems, Inc. detected
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NetCDF Java Library v4.6.0-SNAPSHOT (23 Apr 2015) loaded and ready
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: climate4R.UDG
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>climate4R.UDG version 0.2.3 (2021-07-05) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: Your current version of climate4R.UDG (v0.2.3) is not up-to-date
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Get the latest stable version (0.2.4) using &lt;devtools::install_github(&#39;SantanderMetGroup/climate4R.UDG&#39;)&gt;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Please use &#39;citation(&quot;climate4R.UDG&quot;)&#39; to cite this package.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>loadeR version 1.7.1 (2021-07-05) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Please use &#39;citation(&quot;loadeR&quot;)&#39; to cite this package.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: transformeR
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    _______   ____  ___________________  __  ________ 
   / ___/ /  / /  |/  / __  /_  __/ __/ / / / / __  / 
  / /  / /  / / /|_/ / /_/ / / / / __/ / /_/ / /_/_/  
 / /__/ /__/ / /  / / __  / / / / /__ /___  / / \ \ 
 \___/____/_/_/  /_/_/ /_/ /_/  \___/    /_/\/   \_\ 
 
      github.com/SantanderMetGroup/climate4R
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>transformeR version 2.1.3 (2021-08-04) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: Your current version of transformeR (v2.1.3) is not up-to-date
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Get the latest stable version (2.1.4) using &lt;devtools::install_github(&#39;SantanderMetGroup/transformeR&#39;)&gt;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Please see &#39;citation(&quot;transformeR&quot;)&#39; to cite this package.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>visualizeR version 1.6.1 (2021-03-11) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Please see &#39;citation(&quot;visualizeR&quot;)&#39; to cite this package.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: udunits2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>udunits system database read from /home/phanaur/mambaforge/envs/tfg/share/udunits/udunits2.xml
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>convertR version 0.2.0 (2020-02-22) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  More information about the &#39;climate4R&#39; ecosystem in: http://meteo.unican.es/climate4R
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attaching package: ‘convertR’
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following objects are masked from ‘package:loadeR’:

    hurs2huss, huss2hurs, tdps2hurs
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-the-reference-land-sea-mask">
<h2>Load the reference land/sea mask<a class="headerlink" href="#load-the-reference-land-sea-mask" title="Permalink to this headline">#</a></h2>
<p>The global reference 1º land/sea mask used for the generation of part of the Atlas products can be loaded directly from this repository with the <code class="docutils literal notranslate"><span class="pre">loadGridData</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># global reference 1º land/sea mask</span>
<span class="n">mask</span> <span class="o">&lt;-</span> <span class="nf">loadGridData</span><span class="p">(</span><span class="s">&quot;../reference-grids/land_sea_mask_1degree.nc4&quot;</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="s">&quot;sftlf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:06:47] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:06:48] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NOTE: Undefined Dataset Time Axis (static variable)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:06:48] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:06:48] Done
</pre></div>
</div>
</div>
</div>
<p>This mask is a C4R grid object which contains the land fraction (a value in between 0 and 1) in each gridbox.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting mask</span>
<span class="nf">spatialPlot</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/reference-grids_R_7_0.png" src="../_images/reference-grids_R_7_0.png" />
</div>
</div>
</section>
<section id="load-model-data">
<h2>Load model data<a class="headerlink" href="#load-model-data" title="Permalink to this headline">#</a></h2>
<p>For this example we will use the global mean temperature from the CanESM5 model, which is provided at a monthly time resolution in a netCDF file in the <code class="docutils literal notranslate"><span class="pre">auxiliary-material</span></code> folder. In particular, we focus on the 2000-2010 period, which can be specified with the <code class="docutils literal notranslate"><span class="pre">years</span></code> argument in the <code class="docutils literal notranslate"><span class="pre">loadGridData</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># loading global mean temperature</span>
<span class="n">tas</span> <span class="o">&lt;-</span> <span class="nf">loadGridData</span><span class="p">(</span><span class="s">&quot;auxiliary-material/CMIP6Amon_tas_CanESM5_r1i1p1f1_historical_gn_185001-201412.nc&quot;</span><span class="p">,</span> 
                    <span class="n">var</span> <span class="o">=</span> <span class="s">&quot;tas&quot;</span><span class="p">,</span> <span class="n">years</span> <span class="o">=</span> <span class="m">2000</span><span class="o">:</span><span class="m">2010</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:06:52] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:06:52] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:06:52] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:06:52] Done
</pre></div>
</div>
</div>
</div>
<p>Let’s plot the climatology for the analyzed period:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting climatology</span>
<span class="nf">spatialPlot</span><span class="p">(</span><span class="nf">climatology</span><span class="p">(</span><span class="n">tas</span><span class="p">),</span> <span class="n">backdrop.theme</span> <span class="o">=</span> <span class="s">&quot;coastline&quot;</span><span class="p">,</span> <span class="n">rev.colors</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:06:52] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:06:52] - Done.
</pre></div>
</div>
<img alt="../_images/reference-grids_R_11_2.png" src="../_images/reference-grids_R_11_2.png" />
</div>
</div>
</section>
<section id="interpolation">
<h2>Interpolation<a class="headerlink" href="#interpolation" title="Permalink to this headline">#</a></h2>
<p>The global mean temperature we have just loaded comes in the original grid of the CanESM5 model, which has a spatial resolution of about 2.8º:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">attributes</span><span class="p">(</span><span class="nf">getGrid</span><span class="p">(</span><span class="n">tas</span><span class="p">))</span><span class="o">$</span><span class="n">resX</span>
<span class="nf">attributes</span><span class="p">(</span><span class="nf">getGrid</span><span class="p">(</span><span class="n">tas</span><span class="p">))</span><span class="o">$</span><span class="n">resY</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">2.8125</div><div class="output text_html">2.78932694727723</div></div>
</div>
<p>In order to apply the reference 1º land/sea mask to these data and retain only land temperatures, we need first to interpolate the CanESM5 model to the grid of the mask, which can be done with the <code class="docutils literal notranslate"><span class="pre">interpGrid</span></code> function. We will use in this example bilinear interpolation; however, other interpolation methods are also available in <code class="docutils literal notranslate"><span class="pre">interpGrid</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note: This cell may take a while to run </span>
<span class="n">tas.i</span> <span class="o">&lt;-</span> <span class="nf">interpGrid</span><span class="p">(</span><span class="n">tas</span><span class="p">,</span> <span class="nf">getGrid</span><span class="p">(</span><span class="n">mask</span><span class="p">),</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;bilinear&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in interpGrid(tas, getGrid(mask), method = &quot;bilinear&quot;):
“The new longitudes are outside the data extent”
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in interpGrid(tas, getGrid(mask), method = &quot;bilinear&quot;):
“The new latitudes are outside the data extent”
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:06:53] Performing bilinear interpolation... may take a while
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:06:58] Done
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">attributes</span><span class="p">(</span><span class="nf">getGrid</span><span class="p">(</span><span class="n">tas.i</span><span class="p">))</span><span class="o">$</span><span class="n">resX</span>
<span class="nf">attributes</span><span class="p">(</span><span class="nf">getGrid</span><span class="p">(</span><span class="n">tas.i</span><span class="p">))</span><span class="o">$</span><span class="n">resY</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">1</div><div class="output text_html">1</div></div>
</div>
</section>
<section id="apply-the-mask-to-the-data">
<h2>Apply the mask to the data<a class="headerlink" href="#apply-the-mask-to-the-data" title="Permalink to this headline">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">binaryGrid</span></code> function assigns two user-provided values (here NA and 1) to a given C4R grid object according to a threshold and condition. We use it here to obtain a new binary land/sea mask with 1 over land and NA over sea. Note that a threshold of 0.999 (99.9%) land fraction is used to define land/sea grid points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># binary 1º land/sea mask</span>
<span class="n">land</span> <span class="o">&lt;-</span> <span class="nf">binaryGrid</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="s">&quot;GT&quot;</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="m">0.999</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span>
<span class="nf">spatialPlot</span><span class="p">(</span><span class="n">land</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/reference-grids_R_18_0.png" src="../_images/reference-grids_R_18_0.png" />
</div>
</div>
<p>In order to apply this binary mask to our temperature data, we need that both C4R grid objects have the same dimensions. Therefore, we resize the binary mask to match the time dimension of <code class="docutils literal notranslate"><span class="pre">tas.i</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">masktimes</span> <span class="o">&lt;-</span> <span class="nf">rep</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">land</span><span class="p">),</span> <span class="nf">getShape</span><span class="p">(</span><span class="n">tas.i</span><span class="p">,</span> <span class="s">&quot;time&quot;</span><span class="p">))</span>
<span class="n">mask2apply</span> <span class="o">&lt;-</span> <span class="nf">bindGrid</span><span class="p">(</span><span class="n">masktimes</span><span class="p">,</span> <span class="n">dimension</span> <span class="o">=</span> <span class="s">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in value[[3L]](cond):
“time dimension could not be sorted!”
</pre></div>
</div>
</div>
</div>
<p>At this point, we can already use the <code class="docutils literal notranslate"><span class="pre">gridArithmetics</span></code> function to multiply the binary land/sea mask and the temperature data, making NA over sea in the latter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">tas.i.land</span> <span class="o">&lt;-</span> <span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">tas.i</span><span class="p">,</span> <span class="n">mask2apply</span><span class="p">,</span> <span class="n">operator</span> <span class="o">=</span> <span class="s">&quot;*&quot;</span><span class="p">)</span>

<span class="c1"># final land-only temperature data</span>
<span class="nf">spatialPlot</span><span class="p">(</span><span class="nf">climatology</span><span class="p">(</span><span class="n">tas.i.land</span><span class="p">),</span> <span class="n">rev.colors</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:01] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2022-10-13 10:07:01] - Done.
</pre></div>
</div>
<img alt="../_images/reference-grids_R_22_2.png" src="../_images/reference-grids_R_22_2.png" />
</div>
</div>
</section>
<section id="masked-vs-non-masked-time-series">
<h2>Masked vs. non masked time-series<a class="headerlink" href="#masked-vs-non-masked-time-series" title="Permalink to this headline">#</a></h2>
<p>Next we compare the monthly time-series of mean temperature, spatially averaged over the entire globe (non masked: <code class="docutils literal notranslate"><span class="pre">tas.i</span></code>) and only over land regions (masked: <code class="docutils literal notranslate"><span class="pre">tas.i.land</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># monthly time-series (in K)</span>
<span class="nf">temporalPlot</span><span class="p">(</span><span class="n">tas.i</span><span class="p">,</span> <span class="n">tas.i.land</span><span class="p">,</span> <span class="n">x.axis</span> <span class="o">=</span> <span class="s">&quot;index&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/reference-grids_R_24_0.png" src="../_images/reference-grids_R_24_0.png" />
</div>
</div>
<p>Note that temperature is in K units. The <code class="docutils literal notranslate"><span class="pre">udConvertGrid</span></code> function from the <code class="docutils literal notranslate"><span class="pre">convertR</span></code> package allows for easily passing from K to Celsius degrees:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># monthly time-series (in Celsius degrees)</span>
<span class="n">tas.i.degC</span> <span class="o">&lt;-</span> <span class="nf">udConvertGrid</span><span class="p">(</span><span class="n">tas.i</span><span class="p">,</span> <span class="n">new.units</span> <span class="o">=</span> <span class="s">&quot;degC&quot;</span><span class="p">)</span>
<span class="n">tas.i.land.degC</span> <span class="o">&lt;-</span> <span class="nf">udConvertGrid</span><span class="p">(</span><span class="n">tas.i.land</span><span class="p">,</span> <span class="n">new.units</span> <span class="o">=</span> <span class="s">&quot;degC&quot;</span><span class="p">)</span>
<span class="nf">temporalPlot</span><span class="p">(</span><span class="n">tas.i.degC</span><span class="p">,</span> <span class="n">tas.i.land.degC</span><span class="p">,</span> <span class="n">x.axis</span> <span class="o">=</span> <span class="s">&quot;index&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/reference-grids_R_26_0.png" src="../_images/reference-grids_R_26_0.png" />
</div>
</div>
</section>
<section id="session-info">
<h2>Session info<a class="headerlink" href="#session-info" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">sessionInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R version 3.6.3 (2020-02-29)
Platform: x86_64-conda-linux-gnu (64-bit)
Running under: Fedora Linux 36 (Workstation Edition)

Matrix products: default
BLAS/LAPACK: /home/phanaur/mambaforge/envs/tfg/lib/libopenblasp-r0.3.21.so

locale:
 [1] LC_CTYPE=es_ES.UTF-8          LC_NUMERIC=C                 
 [3] LC_TIME=es_ES.UTF-8           LC_COLLATE=es_ES.UTF-8       
 [5] LC_MONETARY=es_ES.UTF-8       LC_MESSAGES=es_ES.UTF-8      
 [7] LC_PAPER=es_ES.UTF-8          LC_NAME=es_ES.UTF-8          
 [9] LC_ADDRESS=es_ES.UTF-8        LC_TELEPHONE=es_ES.UTF-8     
[11] LC_MEASUREMENT=es_ES.UTF-8    LC_IDENTIFICATION=es_ES.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] convertR_0.2.0      udunits2_0.13       visualizeR_1.6.1   
[4] transformeR_2.1.3   loadeR_1.7.1        climate4R.UDG_0.2.3
[7] loadeR.java_1.1.1   rJava_1.0-4        

loaded via a namespace (and not attached):
 [1] viridis_0.6.1           maps_3.3.0              jsonlite_1.7.2         
 [4] viridisLite_0.4.0       SpecsVerification_0.5-3 dotCall64_1.0-1        
 [7] kohonen_3.0.10          sm_2.2-5.6              sp_1.4-5               
[10] latticeExtra_0.6-29     pillar_1.6.1            lattice_0.20-44        
[13] glue_1.4.2              RcppEigen_0.3.3.9.1     uuid_0.1-4             
[16] digest_0.6.27           RColorBrewer_1.1-2      colorspace_2.0-1       
[19] htmltools_0.5.1.1       Matrix_1.3-3            pkgconfig_2.0.3        
[22] padr_0.5.3              purrr_0.3.4             scales_1.1.1           
[25] jpeg_0.1-8.1            CircStats_0.2-6         dtw_1.22-3             
[28] tibble_3.1.2            proxy_0.4-25            generics_0.1.0         
[31] ggplot2_3.3.3           ellipsis_0.3.2          repr_1.1.3             
[34] verification_1.42       pbapply_1.4-3           magrittr_2.0.1         
[37] crayon_1.4.1            easyVerification_0.4.4  evaluate_0.14          
[40] fansi_0.4.2             MASS_7.3-54             tools_3.6.3            
[43] data.table_1.14.0       lifecycle_1.0.0         munsell_0.5.0          
[46] akima_0.6-2.1           compiler_3.6.3          mapplots_1.5.1         
[49] rlang_0.4.11            grid_3.6.3              RCurl_1.98-1.3         
[52] pbdZMQ_0.3-5            IRkernel_1.2            spam_2.6-0             
[55] bitops_1.0-7            tcltk_3.6.3             base64enc_0.1-3        
[58] boot_1.3-28             vioplot_0.3.6           gtable_0.3.0           
[61] abind_1.4-5             R6_2.5.0                gridExtra_2.3          
[64] zoo_1.8-9               dplyr_1.0.6             utf8_1.2.1             
[67] parallel_3.6.3          IRdisplay_1.0           Rcpp_1.0.6             
[70] fields_12.3             vctrs_0.3.8             png_0.1-7              
[73] tidyselect_1.1.1       
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="linear-trends_R.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Computing and visualization of precipitation linear trends during the observed period (1980-2014)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="reference-regions_Python.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Using the 4th version of the IPCC WGI reference regions in Python</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By David Domínguez Román<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>