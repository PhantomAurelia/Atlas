
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Bias adjustment of model temperatures for the calculation of extreme indices &#8212; IPCC-ATLAS Jupyter Book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "PhantomAurelia/Atlas");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Selecting reference regions used for every CORDEX domain" href="CORDEX-overlaps_Python.html" />
    <link rel="prev" title="Computing and visualizing transient global warming levels" href="global-warming-levels_R.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">IPCC-ATLAS Jupyter Book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Repository supporting the implementation of FAIR principles in the IPCC-WGI Atlas
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Information
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../warming-levels/warming-levels.html">
   Global Warming Levels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-sources/data-sources.html">
   Data sources used in the Atlas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference-grids/reference-grids.html">
   Sets of reference grids
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets-interactive-atlas/datasets-interactive-atlas.html">
   Code for reproducibility of the Interactive Atlas Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference-regions/reference-regions.html">
   Sets of regions for regional synthesis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets-aggregated-regionally/datasets-aggregated-regionally.html">
   Aggregated datasets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Notebooks
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks.html">
   Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="regional-scatter-plots_R.html">
   Atlas notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="global-warming-levels_R.html">
   Computing and visualizing transient global warming levels
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Bias adjustment of model temperatures for the calculation of extreme indices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CORDEX-overlaps_Python.html">
   Selecting reference regions used for every CORDEX domain
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="GeoTIFF-post-processing_R.html">
   GeoTIFF file post-processing: Spatial operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hatching-uncertainty_R.html">
   Calculation and hatching of the uncertainty in projected delta changes.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear-trends_R.html">
   Computing and visualization of precipitation linear trends during the observed period (1980-2014)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reference-grids_R.html">
   Using the Atlas reference grids in
   <code class="docutils literal notranslate">
    <span class="pre">
     R
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reference-regions_Python.html">
   Using the 4th version of the IPCC WGI reference regions in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reference-regions_R.html">
   Using the 4th version of the IPCC WGI reference regions in R
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stripes-plots_R.html">
   Create stripes of anual temperature and precipitation mean values.
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Anexos
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ERRATA.html">
   Errata and problem reporting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reproducibility/reproducibility.html">
   Reproducibility scripts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="auxiliary-material/auxiliary-material.html">
   Auxiliary Materials for Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../binder/binder.html">
   Binder image deployment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reproducibility/maps/maps.html">
   Code for reproducibility of the Atlas Map figures of model projections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reproducibility/observations/observations.html">
   Code for reproducibility of the ATLAS spatial maps of the observed linear trends
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reproducibility/projections/projections.html">
   Code for reproducibility of the ATLAS boxplots and scatterplots of model projections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets-interactive-atlas/bash-interpolation-scripts/bash-interpolation-scripts.html">
   Bash interpolation scripts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../datasets-interactive-atlas/bash-interpolation-scripts/AtlasCDOremappeR_CORDEX/atlasCDOremappeR.html">
   AtlasCDOremappeR for CORDEX RCM simulations
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/PhantomAurelia/Atlas/jb-test?urlpath=tree/./notebooks/bias-adjustment_R.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/PhantomAurelia/Atlas"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/PhantomAurelia/Atlas/issues/new?title=Issue%20on%20page%20%2Fnotebooks/bias-adjustment_R.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/PhantomAurelia/Atlas/edit/jb-test/./notebooks/bias-adjustment_R.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notebooks/bias-adjustment_R.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-packages">
   Loading packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-the-parameters-of-the-experiment">
   Defining the parameters of the experiment
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-datasets">
   Loading datasets
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#online-from-the-user-data-gateway-thredds-access-portal-udg-tap">
     Online from the User Data Gateway - Thredds Access Portal (UDG-TAP)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-local-files">
     From local files
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-biases">
   Model biases
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id13">
   Bias adjustment
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculation-of-extreme-temperature-indices">
   Calculation of extreme temperature indices
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#session-info">
   Session info
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Bias adjustment of model temperatures for the calculation of extreme indices</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-packages">
   Loading packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-the-parameters-of-the-experiment">
   Defining the parameters of the experiment
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-datasets">
   Loading datasets
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#online-from-the-user-data-gateway-thredds-access-portal-udg-tap">
     Online from the User Data Gateway - Thredds Access Portal (UDG-TAP)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-local-files">
     From local files
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-biases">
   Model biases
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id13">
   Bias adjustment
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculation-of-extreme-temperature-indices">
   Calculation of extreme temperature indices
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#session-info">
   Session info
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Atlas notebooks

***

&gt; This notebook reproduces and extends parts of the figures and products of the AR6-WGI Atlas. It is part of a notebook collection available at https://github.com/IPCC-WG1/Atlas for reproducibility and reusability purposes. This work is licensed under a [Creative Commons Attribution 4.0 International License](http://creativecommons.org/licenses/by/4.0).
&gt;
&gt; ![Creative Commons License &gt;](https://i.creativecommons.org/l/by/4.0/88x31.png)
</pre></div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="bias-adjustment-of-model-temperatures-for-the-calculation-of-extreme-indices">
<span id="bias-adjustment"></span><h1>Bias adjustment of model temperatures for the calculation of extreme indices<a class="headerlink" href="#bias-adjustment-of-model-temperatures-for-the-calculation-of-extreme-indices" title="Permalink to this headline">#</a></h1>
<p>29/6/2021</p>
<p><strong>A. Casanueva</strong> (<a class="reference external" href="http://meteo.unican.es">Santander Meteorology Group</a>. Dept. Applied Mathematics and Compute Science, University of Cantabria, Santander, Spain)</p>
<p>Bias adjustment is used in the IPCC interactive Atlas for the calculation of absolute threshold-based indices, namely the number of days with maximum temperature above 35ºC (TX35) and above 40ºC (TX40), and the number of frost days (minimum temperature below 0ºC). More details about bias adjustment can be found in the Atlas chapter from the IPCC-AR6 (Cross-Chapter Box 10.2: “Issues in bias adjustment”) and in <span id="id1">[<a class="reference internal" href="#id75" title="Testing bias adjustment methods for regional climate change applications under observational uncertainty and resolution mismatch - Casanueva - 2020 - Atmospheric Science Letters - Wiley Online Library. https://rmets.onlinelibrary.wiley.com/doi/10.1002/asl.978."><em>Testing Bias Adjustment Methods for Regional Climate Change Applications under Observational Uncertainty and Resolution Mismatch - Casanueva - 2020 - Atmospheric Science Letters - Wiley Online Library</em>, n.d.</a>]</span>.</p>
<p>Among the wide variety of methods typically used by the climate community for bias adjustment, this notebook focuses on ISIMIP3 (<span id="id2">[<a class="reference internal" href="#id46" title="GMD - Trend-preserving bias adjustment and statistical downscaling with ISIMIP3BASD (v1.0). https://gmd.copernicus.org/articles/12/3055/2019/."><em>GMD - Trend-preserving Bias Adjustment and Statistical Downscaling with ISIMIP3BASD (v1.0)</em>, n.d.</a>]</span>), a parametric quantile mapping alternative which has been designed to robustly adjust biases in all percentiles of a distribution whilst preserving their trends. In particular, we use ISIMIP3 in this example to bias-adjust temperature from the r12i1p1 run of the EC-EARTH global climate model, included in the fifth phase of the Coupled Model Intercomparison Project (CMIP5), over the Iberian Peninsula using as reference the W5E5 observational dataset (<a class="reference external" href="https://doi.org/10.5194/essd-12-2097-202">Cucchi et al. 2020</a>). We focus on the boreal summer season (June-July-August) for the calculation of bias-adjusted TX35.</p>
<section id="loading-packages">
<h2>Loading packages<a class="headerlink" href="#loading-packages" title="Permalink to this headline">#</a></h2>
<p>This notebook is based on the R programming language and requires the following <span id="id3">[<a class="reference internal" href="reference-regions_R.html#id20" title="SantanderMetGroup/climate4R. Santander Meteorology Group (UC-CSIC), July 2022."><em>SantanderMetGroup/climate4R</em>, 2022</a>]</span> packages:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">loadeR</span></code> to load climate model and observational datasets (<span id="id4">[<a class="reference internal" href="hatching-uncertainty_R.html#id59" title="The R-based climate4R open framework for reproducible climate data access and post-processing - ScienceDirect. https://www.sciencedirect.com/science/article/abs/pii/S1364815218303049?via%3Dihub."><em>The R-based climate4R Open Framework for Reproducible Climate Data Access and Post-Processing - ScienceDirect</em></a>]</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">climate4R.UDG</span></code> to access harmonized climate data via the <a class="reference external" href="http://meteo.unican.es/udg-tap/">Santander Meteorology Group UDG-TAP</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transformeR</span></code> to manipulate climate data (<span id="id5">[<a class="reference internal" href="hatching-uncertainty_R.html#id59" title="The R-based climate4R open framework for reproducible climate data access and post-processing - ScienceDirect. https://www.sciencedirect.com/science/article/abs/pii/S1364815218303049?via%3Dihub."><em>The R-based climate4R Open Framework for Reproducible Climate Data Access and Post-Processing - ScienceDirect</em></a>]</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">downscaleR</span></code> to adjust systematic model biases (<span id="id6">[<a class="reference internal" href="#id45" title="GMD - Statistical downscaling with the downscaleR package (v3.1.0): contribution to the VALUE intercomparison experiment. https://gmd.copernicus.org/articles/13/1711/2020/."><em>GMD - Statistical Downscaling with the downscaleR Package (v3.1.0): Contribution to the VALUE Intercomparison Experiment</em>, n.d.</a>]</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">climate4R.indices</span></code> to compute climate indices (<span id="id7">[<a class="reference internal" href="hatching-uncertainty_R.html#id59" title="The R-based climate4R open framework for reproducible climate data access and post-processing - ScienceDirect. https://www.sciencedirect.com/science/article/abs/pii/S1364815218303049?via%3Dihub."><em>The R-based climate4R Open Framework for Reproducible Climate Data Access and Post-Processing - ScienceDirect</em></a>]</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">visualizeR</span></code> to produce graphical representations of the results (<span id="id8">[<a class="reference internal" href="#id66" title="An R package to visualize and communicate uncertainty in seasonal climate prediction - ScienceDirect. https://www.sciencedirect.com/science/article/abs/pii/S1364815217305157?via%3Dihub."><em>An R Package to Visualize and Communicate Uncertainty in Seasonal Climate Prediction - ScienceDirect</em>, n.d.</a>]</span>).</p></li>
</ul>
<p>Along with:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rgdal</span></code> to work with spatial data (<span id="id9">[<a class="reference internal" href="#id35" title="CRAN - Package rgdal. https://cran.r-project.org/web/packages/rgdal/index.html."><em>CRAN - Package Rgdal</em>, n.d.</a>]</span>).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">loadeR</span><span class="p">)</span><span class="w"> </span>
<span class="nf">library</span><span class="p">(</span><span class="n">climate4R.UDG</span><span class="p">)</span><span class="w"> </span>
<span class="nf">library</span><span class="p">(</span><span class="n">transformeR</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">downscaleR</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">climate4R.indices</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">visualizeR</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">rgdal</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: rJava
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: loadeR.java
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Java version 11x amd64 by Azul Systems, Inc. detected
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NetCDF Java Library v4.6.0-SNAPSHOT (23 Apr 2015) loaded and ready
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: climate4R.UDG
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>climate4R.UDG version 0.2.3 (2021-07-05) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: Your current version of climate4R.UDG (v0.2.3) is not up-to-date
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Get the latest stable version (0.2.4) using &lt;devtools::install_github(&#39;SantanderMetGroup/climate4R.UDG&#39;)&gt;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Please use &#39;citation(&quot;climate4R.UDG&quot;)&#39; to cite this package.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>loadeR version 1.7.1 (2021-07-05) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Please use &#39;citation(&quot;loadeR&quot;)&#39; to cite this package.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    _______   ____  ___________________  __  ________ 
   / ___/ /  / /  |/  / __  /_  __/ __/ / / / / __  / 
  / /  / /  / / /|_/ / /_/ / / / / __/ / /_/ / /_/_/  
 / /__/ /__/ / /  / / __  / / / / /__ /___  / / \ \ 
 \___/____/_/_/  /_/_/ /_/ /_/  \___/    /_/\/   \_\ 
 
      github.com/SantanderMetGroup/climate4R
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>transformeR version 2.1.3 (2021-08-04) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: Your current version of transformeR (v2.1.3) is not up-to-date
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Get the latest stable version (2.1.4) using &lt;devtools::install_github(&#39;SantanderMetGroup/transformeR&#39;)&gt;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Please see &#39;citation(&quot;transformeR&quot;)&#39; to cite this package.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>downscaleR version 3.3.3 (2021-07-05) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Please use &#39;citation(&quot;downscaleR&quot;)&#39; to cite this package.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>climate4R.indices version 0.2.0 (2021-07-08) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Use &#39;indexShow()&#39; for an overview of the available climate indices and circIndexShow() for the circulation indices.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NOTE: use package climate4R.climdex to calculate ETCCDI indices.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attaching package: ‘climate4R.indices’
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following object is masked from ‘package:transformeR’:

    lambWT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>visualizeR version 1.6.1 (2021-03-11) is loaded
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Please see &#39;citation(&quot;visualizeR&quot;)&#39; to cite this package.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: sp
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>rgdal: version: 1.5-16, (SVN revision 1050)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 3.2.1, released 2020/12/29
Path to GDAL shared files: /home/phanaur/mambaforge/envs/prueba/share/gdal
GDAL binary built with GEOS: TRUE 
Loaded PROJ runtime: Rel. 7.2.0, November 1st, 2020, [PJ_VERSION: 720]
Path to PROJ shared files: /home/phanaur/mambaforge/envs/prueba/share/proj
PROJ CDN enabled: TRUE
Linking to sp version:1.4-5
To mute warnings of possible GDAL/OSR exportToProj4() degradation,
use options(&quot;rgdal_show_exportToProj4_warnings&quot;=&quot;none&quot;) before loading rgdal.
</pre></div>
</div>
</div>
</div>
</section>
<section id="defining-the-parameters-of-the-experiment">
<h2>Defining the parameters of the experiment<a class="headerlink" href="#defining-the-parameters-of-the-experiment" title="Permalink to this headline">#</a></h2>
<p>We start by setting the general parameters that define the experiment to perform: spatial extent (Iberian Peninsula), season (June-July-August), baseline/historical period (1986-2005) and future period/emission scenario (2041-2060, RCP8.5) of interest. We set likewise the codes which identify the desired datasets in the <span id="id10">[<a class="reference internal" href="#id76" title="UDG-TAP Home. http://meteo.unican.es/udg-tap/home."><em>UDG-TAP Home</em></a>]</span> , here W5E5 and EC-EARTH (historical and RCP8.5). Check other available, harmonized datasets with <code class="docutils literal notranslate"><span class="pre">UDG.datasets</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">lons</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-9.25</span><span class="p">,</span><span class="w"> </span><span class="m">3.5</span><span class="p">)</span><span class="w">  </span><span class="c1"># Iberian Peninsula</span>
<span class="n">lats</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">36</span><span class="p">,</span><span class="w"> </span><span class="m">44</span><span class="p">)</span><span class="w">   </span><span class="c1"># Iberian Peninsula</span>

<span class="n">season</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">6</span><span class="o">:</span><span class="m">8</span><span class="w">  </span><span class="c1"># June-July-August</span>
<span class="n">years.hist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1986</span><span class="o">:</span><span class="m">2005</span>
<span class="n">years.rcp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">2041</span><span class="o">:</span><span class="m">2060</span>

<span class="n">dataset.obs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;W5E5&quot;</span><span class="w"> </span>
<span class="n">dataset.hist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;CMIP5_EC-EARTH_r12i1p1_historical&quot;</span>
<span class="n">dataset.rcp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;CMIP5_EC-EARTH_r12i1p1_rcp85&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="loading-datasets">
<h2>Loading datasets<a class="headerlink" href="#loading-datasets" title="Permalink to this headline">#</a></h2>
<p>Next, we will see two alternative ways to load in memory the datasets that are needed to run this experiment. On the one hand, both W5E5 and EC-EARTH can be accessed from the <span id="id11">[<a class="reference internal" href="#id76" title="UDG-TAP Home. http://meteo.unican.es/udg-tap/home."><em>UDG-TAP Home</em>, n.d.</a>]</span>, a THREDDS-based service that provides access to a wide catalogue of popular climate datasets. On the other hand, for the sake of time, these data have been also stored locally as <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code> files and can be directly loaded from the <code class="docutils literal notranslate"><span class="pre">auxiliary-material</span></code> folder. In both cases, the datasets can be easily accessed via the <code class="docutils literal notranslate"><span class="pre">loadGridData</span></code> function.</p>
<section id="online-from-the-user-data-gateway-thredds-access-portal-udg-tap">
<h3>Online from the User Data Gateway - Thredds Access Portal (UDG-TAP)<a class="headerlink" href="#online-from-the-user-data-gateway-thredds-access-portal-udg-tap" title="Permalink to this headline">#</a></h3>
<blockquote>
<div><p>This section takes long to execute due to intensive remote data loading. See the next section (<a class="reference external" href="#From-local-files">From local files</a>) to load these data from a local copy available in the repository and continue with the notebook operations.</p>
</div></blockquote>
<p>Previously defined parameters are used to load daily observed (W5E5) and simulated (EC-EARTH) temperatures from the UDG-TAP. For EC-EARTH, both historical and future (i.e. RCP8.5) simulations are needed. It is important to note that not only mean, but also minimum and maximum temperatures are required by the ISIMIP3 method to adjust maximum and minimum temperature, which are obtained from the correction of the amplitude and skewness of the diurnal temperature cycle.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">load.data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function </span><span class="p">(</span><span class="n">dset</span><span class="p">,</span><span class="w"> </span><span class="n">years</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="p">)</span><span class="w"> </span><span class="nf">loadGridData</span><span class="p">(</span><span class="n">dataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dset</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">var</span><span class="p">,</span>
<span class="w">                                                 </span><span class="n">years</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">years</span><span class="p">,</span>
<span class="w">                                                 </span><span class="n">latLim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lats</span><span class="p">,</span><span class="w"> </span><span class="n">lonLim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lons</span><span class="p">,</span>
<span class="w">                                                 </span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">)</span><span class="w"> </span>
<span class="c1"># Loading mean temperature</span>
<span class="n">y.tas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">load.data</span><span class="p">(</span><span class="n">dataset.obs</span><span class="p">,</span><span class="w"> </span><span class="n">years.hist</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;tas&quot;</span><span class="p">)</span>
<span class="n">x.tas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">load.data</span><span class="p">(</span><span class="n">dataset.hist</span><span class="p">,</span><span class="w"> </span><span class="n">years.hist</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;tas&quot;</span><span class="p">)</span>
<span class="n">newdata.tas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">load.data</span><span class="p">(</span><span class="n">dataset.rcp</span><span class="p">,</span><span class="w"> </span><span class="n">years.rcp</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;tas&quot;</span><span class="p">)</span>

<span class="c1"># Loading minimum temperature</span>
<span class="n">y.tasmin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">load.data</span><span class="p">(</span><span class="n">dataset.obs</span><span class="p">,</span><span class="w"> </span><span class="n">years.hist</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;tasmin&quot;</span><span class="p">)</span>
<span class="n">x.tasmin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">load.data</span><span class="p">(</span><span class="n">dataset.hist</span><span class="p">,</span><span class="w"> </span><span class="n">years.hist</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;tasmin&quot;</span><span class="p">)</span>
<span class="n">newdata.tasmin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">load.data</span><span class="p">(</span><span class="n">dataset.rcp</span><span class="p">,</span><span class="w"> </span><span class="n">years.rcp</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;tasmin&quot;</span><span class="p">)</span>

<span class="c1"># Loading maximum temperature</span>
<span class="n">y.tasmax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">load.data</span><span class="p">(</span><span class="n">dataset.obs</span><span class="p">,</span><span class="w"> </span><span class="n">years.hist</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;tasmax&quot;</span><span class="p">)</span>
<span class="n">x.tasmax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">load.data</span><span class="p">(</span><span class="n">dataset.hist</span><span class="p">,</span><span class="w"> </span><span class="n">years.hist</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;tasmax&quot;</span><span class="p">)</span>
<span class="n">newdata.tasmax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">load.data</span><span class="p">(</span><span class="n">dataset.rcp</span><span class="p">,</span><span class="w"> </span><span class="n">years.rcp</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;tasmax&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Due to the spatial mismatch between model and observations, we upscale W5E5 from its original resolution (0.5º) to a 1º regular grid similar to that of EC-EARTH (1.125º). See <span id="id12">[<a class="reference internal" href="#id75" title="Testing bias adjustment methods for regional climate change applications under observational uncertainty and resolution mismatch - Casanueva - 2020 - Atmospheric Science Letters - Wiley Online Library. https://rmets.onlinelibrary.wiley.com/doi/10.1002/asl.978."><em>Testing Bias Adjustment Methods for Regional Climate Change Applications under Observational Uncertainty and Resolution Mismatch - Casanueva - 2020 - Atmospheric Science Letters - Wiley Online Library</em>, n.d.</a>]</span> for a discussion on this procedure.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">upscale</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span><span class="w"> </span><span class="nf">redim</span><span class="p">(</span><span class="nf">upscaleGrid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">aggr.fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;mean&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)),</span><span class="w"> </span>
<span class="w">                                </span><span class="n">drop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">y.tas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">upscale</span><span class="p">(</span><span class="n">y.tas</span><span class="p">)</span>
<span class="n">y.tasmax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">upscale</span><span class="p">(</span><span class="n">y.tasmax</span><span class="p">)</span>
<span class="n">y.tasmin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">upscale</span><span class="p">(</span><span class="n">y.tasmin</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="from-local-files">
<h3>From local files<a class="headerlink" href="#from-local-files" title="Permalink to this headline">#</a></h3>
<p>Alternatively, these data (both W5E5 and EC-EARTH, for the Iberian Peninsula and the selected time slices) can be directly loaded from the <code class="docutils literal notranslate"><span class="pre">auxiliary-material</span></code> folder by using the <code class="docutils literal notranslate"><span class="pre">loadGridData</span></code> function (skip this section if you have sucessfully loaded your data from the UDG-TAP).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">file.obs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;auxiliary-material/W5E5_IP_tas-tasmin-tasmax_1986-2005_JJA.nc&quot;</span>
<span class="n">file.hist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;auxiliary-material/CMIP5_EC-EARTH_r12i1p1_historical_IP_tas-tasmin-tasmax_1986-2005_JJA.nc&quot;</span>
<span class="n">file.rcp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;auxiliary-material/CMIP5_EC-EARTH_r12i1p1_rcp85_IP_tas-tasmin-tasmax_2041-2060_JJA.nc&quot;</span>

<span class="c1"># Loading mean temperature</span>
<span class="n">y.tas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">loadGridData</span><span class="p">(</span><span class="n">file.obs</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;tas&quot;</span><span class="p">)</span>
<span class="n">x.tas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">loadGridData</span><span class="p">(</span><span class="n">file.hist</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;tas&quot;</span><span class="p">)</span>
<span class="n">newdata.tas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">loadGridData</span><span class="p">(</span><span class="n">file.rcp</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;tas&quot;</span><span class="p">)</span>

<span class="c1"># Loading minimum temperature</span>
<span class="n">y.tasmin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">loadGridData</span><span class="p">(</span><span class="n">file.obs</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;tasmin&quot;</span><span class="p">)</span>
<span class="n">x.tasmin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">loadGridData</span><span class="p">(</span><span class="n">file.hist</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;tasmin&quot;</span><span class="p">)</span>
<span class="n">newdata.tasmin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">loadGridData</span><span class="p">(</span><span class="n">file.rcp</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;tasmin&quot;</span><span class="p">)</span>

<span class="c1"># Loading maximum temperature</span>
<span class="n">y.tasmax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">loadGridData</span><span class="p">(</span><span class="n">file.obs</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;tasmax&quot;</span><span class="p">)</span>
<span class="n">x.tasmax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">loadGridData</span><span class="p">(</span><span class="n">file.hist</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;tasmax&quot;</span><span class="p">)</span>
<span class="n">newdata.tasmax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">loadGridData</span><span class="p">(</span><span class="n">file.rcp</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;tasmax&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:26] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:26] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:26] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:26] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:30] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:30] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:30] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:30] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:34] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:34] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:34] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:34] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:38] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:38] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:38] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:39] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:43] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:43] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:43] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:43] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:47] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:47] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:47] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:47] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:51] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:51] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:51] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:51] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:55] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:55] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:55] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:21:56] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] Defining geo-location parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] Defining time selection parameters
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] Retrieving data subset ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] Done
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="model-biases">
<h2>Model biases<a class="headerlink" href="#model-biases" title="Permalink to this headline">#</a></h2>
<p>We continue by exploring EC-EARTH systematic biases compared to W5E5. For this purpose we interpolate the historical EC-EARTH simulations (recall, at 1.125º) to the W5E5’s grid (at 1º) with <code class="docutils literal notranslate"><span class="pre">interpGrid</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">hist.tas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">interpGrid</span><span class="p">(</span><span class="n">x.tas</span><span class="p">,</span><span class="w"> </span><span class="n">new.coordinates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">getGrid</span><span class="p">(</span><span class="n">y.tas</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;nearest&quot;</span><span class="p">)</span>
<span class="n">hist.tasmin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">interpGrid</span><span class="p">(</span><span class="n">x.tasmin</span><span class="p">,</span><span class="w"> </span><span class="n">new.coordinates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">getGrid</span><span class="p">(</span><span class="n">y.tasmin</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;nearest&quot;</span><span class="p">)</span>
<span class="n">hist.tasmax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">interpGrid</span><span class="p">(</span><span class="n">x.tasmax</span><span class="p">,</span><span class="w"> </span><span class="n">new.coordinates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">getGrid</span><span class="p">(</span><span class="n">y.tasmax</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;nearest&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] Calculating nearest neighbors...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] Performing nearest interpolation... may take a while
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] Calculating nearest neighbors...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] Performing nearest interpolation... may take a while
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] Calculating nearest neighbors...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] Performing nearest interpolation... may take a while
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] Done
</pre></div>
</div>
</div>
</div>
<p>Please note that nearest neighbour interpolation is internally performed within the <code class="docutils literal notranslate"><span class="pre">biasCorrection</span></code> function (which will be used later) when observations and model grids do not match. Nevertheless, we explicitly do it here for biases calculation. Mean bias of daily mean, maximum and minimum temperature during the historical period are computed with <code class="docutils literal notranslate"><span class="pre">gridArithmetics</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">bias.tas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="nf">climatology</span><span class="p">(</span><span class="n">hist.tas</span><span class="p">),</span><span class="w"> </span><span class="nf">climatology</span><span class="p">(</span><span class="n">y.tas</span><span class="p">),</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">)</span>
<span class="n">bias.tasmax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="nf">climatology</span><span class="p">(</span><span class="n">hist.tasmax</span><span class="p">),</span><span class="w"> </span><span class="nf">climatology</span><span class="p">(</span><span class="n">y.tasmax</span><span class="p">),</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">)</span>
<span class="n">bias.tasmin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="nf">climatology</span><span class="p">(</span><span class="n">hist.tasmin</span><span class="p">),</span><span class="w"> </span><span class="nf">climatology</span><span class="p">(</span><span class="n">y.tasmin</span><span class="p">),</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] - Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] - Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] - Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] - Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] - Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] - Done.
</pre></div>
</div>
</div>
</div>
<p>The results are plotted with the <code class="docutils literal notranslate"><span class="pre">spatialPlot</span></code> function from the <code class="docutils literal notranslate"><span class="pre">visualizeR</span></code> package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">spatialPlot</span><span class="p">(</span><span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">makeMultiGrid</span><span class="p">(</span><span class="n">bias.tas</span><span class="p">,</span><span class="w"> </span><span class="n">bias.tasmax</span><span class="p">,</span><span class="w"> </span><span class="n">bias.tasmin</span><span class="p">,</span><span class="w"> </span><span class="n">skip.temporal.check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)),</span><span class="w"> </span>
<span class="w">            </span><span class="n">backdrop.theme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;coastline&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">names.attr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Mean temperature&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Maximum Temperature&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Minimum Temperature&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;EC-EARTH biases (degC)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">as.table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">set.min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-6</span><span class="p">,</span><span class="w"> </span><span class="n">set.max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-6</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="o">/</span><span class="m">20</span><span class="p">),</span><span class="w"> </span><span class="n">rev.colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bias-adjustment_R_19_0.png" src="../_images/bias-adjustment_R_19_0.png" />
</div>
</div>
<p>Similarly, we can also visualize the EC-EARTH bias for TX35 (number of days per year with maximum temperature above 35º) during the historical period. This index can be easily computed with the <code class="docutils literal notranslate"><span class="pre">indexGrid</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Observed TX35, year by year</span>
<span class="n">index.obs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">redim</span><span class="p">(</span><span class="nf">indexGrid</span><span class="p">(</span><span class="n">tx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y.tasmax</span><span class="p">,</span><span class="w"> </span><span class="n">index.code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;TXth&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">35</span><span class="p">,</span><span class="w"> </span><span class="n">time.resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;year&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">                   </span><span class="n">drop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="c1"># Simulated TX35, year by year</span>
<span class="n">index.raw</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">redim</span><span class="p">(</span><span class="nf">indexGrid</span><span class="p">(</span><span class="n">tx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hist.tasmax</span><span class="p">,</span><span class="w"> </span><span class="n">index.code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;TXth&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">35</span><span class="p">,</span><span class="w"> </span><span class="n">time.resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;year&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">                   </span><span class="n">drop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">tx35.obs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">climatology</span><span class="p">(</span><span class="n">index.obs</span><span class="p">)</span><span class="w">  </span><span class="c1"># Mean value</span>
<span class="n">tx35.raw</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">climatology</span><span class="p">(</span><span class="n">index.raw</span><span class="p">)</span><span class="w">  </span><span class="c1"># Mean value</span>
<span class="n">bias.tx35</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">tx35.raw</span><span class="p">,</span><span class="w"> </span><span class="n">tx35.obs</span><span class="p">,</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># Bias</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:00] Calculating TXth ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:01] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:01] Calculating TXth ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:01] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:01] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:01] - Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:01] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:01] - Done.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">spatialPlot</span><span class="p">(</span><span class="n">bias.tx35</span><span class="p">,</span><span class="w"> </span><span class="n">backdrop.theme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;coastline&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;EC-EARTH bias in TX35 (days/year)&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">set.min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-30</span><span class="p">,</span><span class="w"> </span><span class="n">set.max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-30</span><span class="p">,</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="m">60</span><span class="o">/</span><span class="m">20</span><span class="p">),</span>
<span class="w">            </span><span class="n">rev.colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bias-adjustment_R_22_0.png" src="../_images/bias-adjustment_R_22_0.png" />
</div>
</div>
</section>
<section id="id13">
<h2>Bias adjustment<a class="headerlink" href="#id13" title="Permalink to this headline">#</a></h2>
<p>Three individual adjustments need to be done to get bias-adjusted daily minimum and maximum temperatures with the ISIMIP3 method:</p>
<ol class="simple">
<li><p>Bias adjustment of mean temperature</p></li>
<li><p>Bias adjustment of temperature range</p></li>
<li><p>Bias adjustment of temperature skewness</p></li>
</ol>
<p>In this example, the three steps are next undertaken to correct both historical and future model simulations.</p>
<p>We start by calculating the temperature range and skewness for the observations and (historical and future) simulations using the <code class="docutils literal notranslate"><span class="pre">gridArithmetics</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Range</span>
<span class="n">y.range</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">y.tasmax</span><span class="p">,</span><span class="w"> </span><span class="n">y.tasmin</span><span class="p">,</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">)</span>
<span class="n">x.range</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">x.tasmax</span><span class="p">,</span><span class="w"> </span><span class="n">x.tasmin</span><span class="p">,</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">)</span>
<span class="n">newdata.range</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">newdata.tasmax</span><span class="p">,</span><span class="w"> </span><span class="n">newdata.tasmin</span><span class="p">,</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">)</span>

<span class="c1"># Skewness</span>
<span class="n">y.skew</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">y.tas</span><span class="p">,</span><span class="w"> </span><span class="n">y.tasmin</span><span class="p">,</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">y.range</span><span class="p">,</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p">)</span>
<span class="n">x.skew</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">x.tas</span><span class="p">,</span><span class="n">x.tasmin</span><span class="p">,</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">x.range</span><span class="p">,</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p">)</span>
<span class="n">newdata.skew</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">newdata.tas</span><span class="p">,</span><span class="w"> </span><span class="n">newdata.tasmin</span><span class="p">,</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">                                </span><span class="n">newdata.range</span><span class="p">,</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next, the <code class="docutils literal notranslate"><span class="pre">biasCorrection</span></code> function is used to perform the three steps mentioned above, by indicating the ISIMIP3 method and related arguments as inputs. Other (methodologically simpler) methods are also available in <code class="docutils literal notranslate"><span class="pre">biasCorrection</span></code>; the reader is referred to the function documentation for more details.</p>
<p>1.Bias adjustment of daily mean temperature:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># List of arguments that have to be passed to the &quot;biasCorrection&quot; function when using the ISIMIP3 method</span>
<span class="n">isimip3.args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">lower_bound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="n">lower_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">upper_bound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">upper_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w">  </span><span class="n">randomization_seed</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">detrend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">array</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">rotation_matrices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">n_quantiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;normal&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">trend_preservation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">array</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;additive&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span>
<span class="w">                    </span><span class="n">adjust_p_values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">array</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">if_all_invalid_use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span>
<span class="w">                    </span><span class="n">invalid_value_warnings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>

<span class="c1"># Adjusting historical simulations</span>
<span class="n">bc.tas.hist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">biasCorrection</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y.tas</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x.tas</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x.tas</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;precipitation&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;isimip3&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">isimip3.args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isimip3.args</span><span class="p">)</span>
<span class="c1"># Adjusting future simulations</span>
<span class="n">bc.tas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">biasCorrection</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y.tas</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x.tas</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newdata.tas</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;precipitation&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;isimip3&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">isimip3.args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isimip3.args</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:01] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:01] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:01] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:01] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:01] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:01] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:02] Argument precipitation is set as FALSE, please ensure that this matches your data.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:02] Number of windows considered: 1...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:02] Bias-correcting 1 members separately...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:14] Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:14] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:14] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:14] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:14] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:14] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:14] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:14] Argument precipitation is set as FALSE, please ensure that this matches your data.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:14] Number of windows considered: 1...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:14] Bias-correcting 1 members separately...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:23] Done.
</pre></div>
</div>
</div>
</div>
<p>2.Bias ajustment of the daily temperature range:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># List of arguments that have to be passed to the &quot;biasCorrection&quot; function when using the ISIMIP3 method</span>
<span class="n">isimip3.range.args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">lower_bound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">lower_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">upper_bound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span>
<span class="w">                            </span><span class="n">upper_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">randomization_seed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span>
<span class="w">                            </span><span class="n">detrend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">array</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">rotation_matrices</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span>
<span class="w">                            </span><span class="n">n_quantiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;rice&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                            </span><span class="n">trend_preservation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">array</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;mixed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">),</span>
<span class="w">                            </span><span class="n">adjust_p_values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">array</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">if_all_invalid_use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span>
<span class="w">                            </span><span class="n">invalid_value_warnings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>

<span class="c1"># Adjusting historical simulations</span>
<span class="n">bc.range.hist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">biasCorrection</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y.range</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x.range</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x.range</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;precipitation&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;isimip3&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">isimip3.args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isimip3.range.args</span><span class="p">)</span>
<span class="c1"># Adjusting future simulations                           </span>
<span class="n">bc.range</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">biasCorrection</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y.range</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x.range</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newdata.range</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;precipitation&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span>
<span class="w">                           </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;isimip3&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">isimip3.args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isimip3.range.args</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:23] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:23] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:23] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:23] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:23] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:23] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:23] Argument precipitation is set as FALSE, please ensure that this matches your data.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:23] Number of windows considered: 1...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:23] Bias-correcting 1 members separately...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:31] Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:31] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:31] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:31] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:31] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:31] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:31] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:31] Argument precipitation is set as FALSE, please ensure that this matches your data.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:31] Number of windows considered: 1...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:31] Bias-correcting 1 members separately...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:39] Done.
</pre></div>
</div>
</div>
</div>
<p>3.Bias adjustment of the daily temperature skewness:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># List of arguments that have to be passed to the &quot;biasCorrection&quot; function when using the ISIMIP3 method</span>
<span class="n">isimip3.skew.args</span><span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="nf">list</span><span class="p">(</span><span class="n">lower_bound</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">lower_threshold</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="m">0.0001</span><span class="p">),</span><span class="w"> </span><span class="n">upper_bound</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span>
<span class="w">                           </span><span class="n">upper_threshold</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="m">0.9999</span><span class="p">),</span><span class="w"> </span><span class="n">randomization_seed</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="kc">NULL</span><span class="p">,</span>
<span class="w">                           </span><span class="n">detrend</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">array</span><span class="p">(</span><span class="n">data</span><span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">rotation_matrices</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="kc">NULL</span><span class="p">),</span><span class="w"> </span>
<span class="w">                           </span><span class="n">n_quantiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;beta&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">                           </span><span class="n">trend_preservation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">array</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;bounded&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span>
<span class="w">                           </span><span class="n">adjust_p_values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">array</span><span class="p">(</span><span class="n">data</span><span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">if_all_invalid_use</span><span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="nf">c</span><span class="p">(</span><span class="kc">NULL</span><span class="p">),</span>
<span class="w">                           </span><span class="n">invalid_value_warnings</span><span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="kc">FALSE</span><span class="p">)</span>

<span class="c1"># Adjusting historical simulations</span>
<span class="n">bc.skew.hist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">biasCorrection</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y.skew</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x.skew</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x.skew</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;precipitation&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span>
<span class="w">                          </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;isimip3&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">isimip3.args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isimip3.skew.args</span><span class="p">)</span>
<span class="c1"># Adjusting future simulations</span>
<span class="n">bc.skew</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">biasCorrection</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y.skew</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x.skew</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newdata.skew</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;precipitation&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span>
<span class="w">                          </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;isimip3&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">isimip3.args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isimip3.skew.args</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:39] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:39] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:39] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:39] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:39] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:39] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:39] Argument precipitation is set as FALSE, please ensure that this matches your data.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:39] Number of windows considered: 1...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:39] Bias-correcting 1 members separately...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:47] Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:47] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:47] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:47] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:47] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:47] Trying to determine the time zone...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:47] Time zone identified and set to GMT
See &#39;setGridDates.asPOSIXlt&#39; to change the time zone
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:47] Argument precipitation is set as FALSE, please ensure that this matches your data.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:47] Number of windows considered: 1...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:47] Bias-correcting 1 members separately...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:55] Done.
</pre></div>
</div>
</div>
</div>
<p>Once these three steps are completed, the bias-adjusted daily maximum and minimum temperature can be obtained as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bias-adjusted historical temperatures</span>
<span class="n">bc.tasmin.hist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">bc.tas.hist</span><span class="p">,</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">bc.range.hist</span><span class="p">,</span><span class="w"> </span><span class="n">bc.skew.hist</span><span class="p">,</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">                                  </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">)</span>
<span class="n">bc.tasmax.hist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">bc.tasmin.hist</span><span class="p">,</span><span class="w"> </span><span class="n">bc.range.hist</span><span class="p">,</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;+&quot;</span><span class="p">)</span>

<span class="c1"># Bias-adjusted future temperatures</span>
<span class="n">bc.tasmin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">bc.tas</span><span class="p">,</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">bc.range</span><span class="p">,</span><span class="w"> </span><span class="n">bc.skew</span><span class="p">,</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">                             </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">)</span>
<span class="n">bc.tasmax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">gridArithmetics</span><span class="p">(</span><span class="n">bc.tasmin</span><span class="p">,</span><span class="w"> </span><span class="n">bc.range</span><span class="p">,</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;+&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculation-of-extreme-temperature-indices">
<h2>Calculation of extreme temperature indices<a class="headerlink" href="#calculation-of-extreme-temperature-indices" title="Permalink to this headline">#</a></h2>
<p>Finally, we use the <code class="docutils literal notranslate"><span class="pre">indexGrid</span></code> function to compute historical and future TX35 based on the bias-adjusted daily maximum temperature which has been obtained from the application of the ISIMIP3 method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bias-adjusted TX35 for the historical period, year by year</span>
<span class="n">index.hist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">redim</span><span class="p">(</span><span class="nf">indexGrid</span><span class="p">(</span><span class="n">tx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bc.tasmax.hist</span><span class="p">,</span><span class="w"> </span><span class="n">index.code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;TXth&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">35</span><span class="p">,</span><span class="w"> </span>
<span class="w">                              </span><span class="n">time.resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;year&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">tx35.hist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">climatology</span><span class="p">(</span><span class="n">index.hist</span><span class="p">)</span><span class="w">  </span><span class="c1"># Mean value (number of days/year)</span>

<span class="c1"># Bias-adjusted TX35 for the future period of interest, year by year</span>
<span class="n">index.rcp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">redim</span><span class="p">(</span><span class="nf">indexGrid</span><span class="p">(</span><span class="n">tx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bc.tasmax</span><span class="p">,</span><span class="w"> </span><span class="n">index.code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;TXth&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">35</span><span class="p">,</span><span class="w"> </span>
<span class="w">                             </span><span class="n">time.resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;year&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">tx35.rcp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">climatology</span><span class="p">(</span><span class="n">index.rcp</span><span class="p">)</span><span class="w"> </span><span class="c1"># Mean value (number of days/year)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:56] Calculating TXth ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:56] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:56] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:56] - Done.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:56] Calculating TXth ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:56] Done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:56] - Computing climatology...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2023-01-16 11:22:56] - Done.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">spatialPlot</span><span class="p">(</span><span class="nf">makeMultiGrid</span><span class="p">(</span><span class="n">tx35.hist</span><span class="p">,</span><span class="w"> </span><span class="n">tx35.rcp</span><span class="p">,</span><span class="w"> </span><span class="n">skip.temporal.check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="n">backdrop.theme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;coastline&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">            </span><span class="n">color.them</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Reds&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">names.attr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Historical (1986-2005)&quot;</span><span class="p">,</span><span class="s">&quot;Projected (2041-2060, RCP8.5)&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Bias-adjusted TX35 (days/year)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">as.table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">set.min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">set.max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">60</span><span class="p">,</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">60</span><span class="p">,</span><span class="m">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bias-adjustment_R_36_0.png" src="../_images/bias-adjustment_R_36_0.png" />
</div>
</div>
</section>
<section id="session-info">
<h2>Session info<a class="headerlink" href="#session-info" title="Permalink to this headline">#</a></h2>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">sessionInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R version 3.6.3 (2020-02-29)
Platform: x86_64-conda-linux-gnu (64-bit)
Running under: Fedora Linux 37 (Workstation Edition)

Matrix products: default
BLAS/LAPACK: /home/phanaur/mambaforge/envs/prueba/lib/libopenblasp-r0.3.21.so

locale:
 [1] LC_CTYPE=es_ES.UTF-8          LC_NUMERIC=C                 
 [3] LC_TIME=es_ES.UTF-8           LC_COLLATE=es_ES.UTF-8       
 [5] LC_MONETARY=es_ES.UTF-8       LC_MESSAGES=es_ES.UTF-8      
 [7] LC_PAPER=es_ES.UTF-8          LC_NAME=es_ES.UTF-8          
 [9] LC_ADDRESS=es_ES.UTF-8        LC_TELEPHONE=es_ES.UTF-8     
[11] LC_MEASUREMENT=es_ES.UTF-8    LC_IDENTIFICATION=es_ES.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] rgdal_1.5-16            sp_1.4-5                visualizeR_1.6.1       
 [4] climate4R.indices_0.2.0 downscaleR_3.3.3        transformeR_2.1.3      
 [7] loadeR_1.7.1            climate4R.UDG_0.2.3     loadeR.java_1.1.1      
[10] rJava_1.0-4            

loaded via a namespace (and not attached):
 [1] CircStats_0.2-6         bitops_1.0-7            RColorBrewer_1.1-2     
 [4] rprojroot_2.0.2         evd_2.3-3               sticky_0.5.6.1         
 [7] repr_1.1.3              tools_3.6.3             padr_0.5.3             
[10] utf8_1.2.1              R6_2.5.0                sm_2.2-5.6             
[13] DBI_1.1.1               colorspace_2.0-1        withr_2.4.2            
[16] tidyselect_1.1.1        gridExtra_2.3           compiler_3.6.3         
[19] glmnet_4.1-1            scales_1.1.1            pbapply_1.4-3          
[22] dtw_1.22-3              proxy_0.4-25            rappdirs_0.3.3         
[25] pbdZMQ_0.3-5            digest_0.6.27           vioplot_0.3.6          
[28] base64enc_0.1-3         jpeg_0.1-8.1            pkgconfig_2.0.3        
[31] htmltools_0.5.1.1       akima_0.6-2.1           maps_3.3.0             
[34] rlang_0.4.11            shape_1.4.6             mapplots_1.5.1         
[37] generics_0.1.0          zoo_1.8-9               jsonlite_1.7.2         
[40] dplyr_1.0.6             RCurl_1.98-1.3          magrittr_2.0.1         
[43] verification_1.42       dotCall64_1.0-1         Matrix_1.3-3           
[46] Rcpp_1.0.6              IRkernel_1.2            munsell_0.5.0          
[49] fansi_0.4.2             abind_1.4-5             reticulate_1.27        
[52] viridis_0.6.1           lifecycle_1.0.0         MASS_7.3-54            
[55] grid_3.6.3              parallel_3.6.3          crayon_1.4.1           
[58] udunits2_0.13           lattice_0.20-44         IRdisplay_1.0          
[61] convertR_0.2.0          splines_3.6.3           pillar_1.6.1           
[64] tcltk_3.6.3             uuid_0.1-4              boot_1.3-28            
[67] codetools_0.2-18        glue_1.4.2              evaluate_0.14          
[70] latticeExtra_0.6-29     kohonen_3.0.10          data.table_1.14.0      
[73] png_0.1-7               vctrs_0.3.8             spam_2.6-0             
[76] foreach_1.5.1           gtable_0.3.0            purrr_0.3.4            
[79] assertthat_0.2.1        ggplot2_3.3.3           RcppEigen_0.3.3.9.1    
[82] survival_3.2-11         viridisLite_0.4.0       tibble_3.1.2           
[85] iterators_1.0.13        SpecsVerification_0.5-3 fields_12.3            
[88] deepnet_0.2             ellipsis_0.3.2          easyVerification_0.4.4 
[91] here_1.0.1             
</pre></div>
</div>
</div>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Bedia, J., Baño-Medina, J., Legasa, M.N., Iturbide, M., Manzanas, R., Herrera, S., Casanueva, A., San-Martín, D., Cofiño, A.S. and Gutiérrez, J.M. (2020) Statistical downscaling with the downscaleR package (v3.1.0): contribution to the VALUE intercomparison experiment. Geoscientific Model Developmen, 13, 1711–1735.
<a class="reference external" href="https://doi.org/10.5194/gmd-13-1711-2020">https://doi.org/10.5194/gmd-13-1711-2020</a>.</p></li>
<li><p>Bivand R.S., Keitt T., Rowlingson B. (2018). rgdal: Bindings for the ‘Geospatial’ Data Abstraction Library. R package version 1.3-6. <a class="reference external" href="https://CRAN.R-project.org/package=rgdal">https://CRAN.R-project.org/package=rgdal</a></p></li>
<li><p>Casanueva, A, Herrera, S, Iturbide, M, et al. (2020) Testing bias adjustment methods for regional climate change applications under observational uncertainty and resolution mismatch. Atmos Sci Lett. 21: 21:e978. <a class="reference external" href="https://doi.org/10.1002/asl.978">https://doi.org/10.1002/asl.978</a></p></li>
<li><p>Cucchi, M.,Weedon, G. P., Amici, A., Bellouin, N., Lange, S., Schmied, H. M., Hersbach, H. and Buontempo, C. (2020) WFDE5: bias-adjusted ERA5 reanalysis data for impact studies. Earth System Science Data, 12, 2097–2120,  <a class="reference external" href="https://doi.org/10.5194/essd-12-2097-2020">https://doi.org/10.5194/essd-12-2097-2020</a>.</p></li>
<li><p>Frías, M.D., Iturbide, M., Manzanas, R., Bedia, J., Fernández, J., Herrera, S., Cofiño, A.S., Gutiérrez, J.M. (2018). An R package to visualize and communicate uncertainty in seasonal climate prediction. Environ. Model. Software 99, 101–110. <a class="reference external" href="https://doi.org/10.1016/j.envsoft.2017.09.008">https://doi.org/10.1016/j.envsoft.2017.09.008</a>.</p></li>
<li><p>Iturbide, M., Bedia, J., Herrera, S., Baño-Medina, J., Fernández, J., Frías, M. D., Manzanas, R., San-Martín, D., Cimadevilla, E., Cofiño, A. S., and Gutiérrez, J. M. (2019) The R-based climate4R open framework for reproducible climate data access and post-processing, Environ. Modell. Softw., 111, 42–54,
<a class="reference external" href="https://doi.org/10.1016/j.envsoft.2018.09.009">https://doi.org/10.1016/j.envsoft.2018.09.009</a>.</p></li>
<li><p>Lange, S. (2019) Trend-preserving bias adjustment and statistical downscaling with ISIMIP3BASD (v1.0). Geoscientific Model Development, 12, 3055–3070. <a class="reference external" href="https://doi.org/10.5194/gmd-12-3055-2019">https://doi.org/10.5194/gmd-12-3055-2019</a>.</p></li>
</ul>
<div class="docutils container" id="id14">
<dl class="citation">
<dt class="label" id="id66"><span class="brackets"><a class="fn-backref" href="#id8">Pac</a></span></dt>
<dd><p>An R package to visualize and communicate uncertainty in seasonal climate prediction - ScienceDirect. https://www.sciencedirect.com/science/article/abs/pii/S1364815217305157?via%3Dihub.</p>
</dd>
<dt class="label" id="id75"><span class="brackets">Tes</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id12">2</a>)</span></dt>
<dd><p>Testing bias adjustment methods for regional climate change applications under observational uncertainty and resolution mismatch - Casanueva - 2020 - Atmospheric Science Letters - Wiley Online Library. https://rmets.onlinelibrary.wiley.com/doi/10.1002/asl.978.</p>
</dd>
<dt class="label" id="id69"><span class="brackets">Rba</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id5">2</a>,<a href="#id7">3</a>)</span></dt>
<dd><p>The R-based climate4R open framework for reproducible climate data access and post-processing - ScienceDirect. https://www.sciencedirect.com/science/article/abs/pii/S1364815218303049?via%3Dihub.</p>
</dd>
<dt class="label" id="id35"><span class="brackets"><a class="fn-backref" href="#id9">CRA</a></span></dt>
<dd><p>CRAN - Package rgdal. https://cran.r-project.org/web/packages/rgdal/index.html.</p>
</dd>
<dt class="label" id="id45"><span class="brackets"><a class="fn-backref" href="#id6">GMDa</a></span></dt>
<dd><p>GMD - Statistical downscaling with the downscaleR package (v3.1.0): contribution to the VALUE intercomparison experiment. https://gmd.copernicus.org/articles/13/1711/2020/.</p>
</dd>
<dt class="label" id="id46"><span class="brackets"><a class="fn-backref" href="#id2">GMDb</a></span></dt>
<dd><p>GMD - Trend-preserving bias adjustment and statistical downscaling with ISIMIP3BASD (v1.0). https://gmd.copernicus.org/articles/12/3055/2019/.</p>
</dd>
<dt class="label" id="id76"><span class="brackets">UDG</span><span class="fn-backref">(<a href="#id10">1</a>,<a href="#id11">2</a>)</span></dt>
<dd><p>UDG-TAP Home. http://meteo.unican.es/udg-tap/home.</p>
</dd>
<dt class="label" id="id28"><span class="brackets"><a class="fn-backref" href="#id3">cli22</a></span></dt>
<dd><p>SantanderMetGroup/climate4R. Santander Meteorology Group (UC-CSIC), July 2022.</p>
</dd>
</dl>
</div>
<script src="https://utteranc.es/client.js"
        repo="PhantomAurelia/Atlas"
        issue-term="pathname"
        theme="preferred-color-scheme"
        crossorigin="anonymous"
        async>
</script></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="global-warming-levels_R.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Computing and visualizing transient global warming levels</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="CORDEX-overlaps_Python.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Selecting reference regions used for every CORDEX domain</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By David Domínguez Román<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>